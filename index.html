<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MultiGenio - Tu aliado en el aprendizaje</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #3f68a2; /* Azul más suave */
      --secondary-color: #6ed3b3; /* Azul verdoso del logo */
      --accent-color: #f39c12; /* Naranja para énfasis */
      --text-dark: #34495e;
      --text-light: #5e6c7d;
      --bg-light: #f8f9fa;
      --bg-white: #ffffff;
      --shadow-light: rgba(0, 0, 0, 0.08);
      --border-radius: 10px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-light);
      color: var(--text-light);
      line-height: 1.7;
    }

    /* NUEVO: Auth Forms */
    .auth-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: linear-gradient(to bottom right, #e0f7fa, #f0f8ff);
      padding: 20px;
      box-sizing: border-box;
    }
    .auth-container h2 {
      color: var(--primary-color);
      margin-bottom: 25px;
      font-size: 2.5em;
      font-weight: 700;
      text-align: center;
    }
    .auth-form {
      background: var(--bg-white);
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 8px 25px var(--shadow-light);
      max-width: 450px;
      width: 100%;
      margin-bottom: 30px;
      box-sizing: border-box;
    }
    .auth-form input {
      width: calc(100% - 40px);
      padding: 15px 20px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1.1em;
      color: var(--text-dark);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .auth-form input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(63, 104, 162, 0.2);
      outline: none;
    }
    .auth-form button {
      background: var(--secondary-color);
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.2em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      width: 100%;
      margin-top: 20px;
    }
    .auth-form button:hover {
      background: var(--primary-color);
      transform: translateY(-2px);
    }
    #logout-button {
      background: #dc3545; /* Rojo para salir */
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: background 0.3s ease;
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: none; /* Hidden by default */
    }
    #logout-button:hover {
      background: #c82333;
    }


    /* Header */
    header {
      background: var(--primary-color);
      color: var(--bg-white);
      padding: 30px 20px;
      text-align: center;
      box-shadow: 0 2px 10px var(--shadow-light);
    }
    header .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px; /* Espacio entre logo y texto */
      margin-bottom: 10px;
    }
    header .logo-container img {
      height: 80px; /* Tamaño del logo */
      width: auto;
    }
    header h1 {
      font-size: 3em;
      margin: 0;
      font-weight: 700;
      line-height: 1;
    }
    header p {
      font-size: 1.3em;
      margin-top: 5px;
      font-weight: 300;
    }

    /* Navigation */
    nav {
      background: var(--secondary-color);
      display: flex;
      justify-content: center;
      padding: 15px 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    nav a {
      color: var(--bg-white);
      margin: 0 20px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1em;
      padding: 5px 0;
      transition: color 0.3s ease, border-bottom 0.3s ease;
      border-bottom: 2px solid transparent;
    }
    nav a:hover {
      color: var(--accent-color);
      border-bottom: 2px solid var(--accent-color);
    }

    /* Hero Section */
    .hero {
      padding: 80px 20px;
      text-align: center;
      background: linear-gradient(to bottom right, #e0f7fa, #f0f8ff);
      color: var(--text-dark);
    }
    .hero h1 {
      font-size: 3.2em;
      margin-bottom: 20px;
      font-weight: 700;
      color: var(--primary-color);
      line-height: 1.2;
    }
    .hero p {
      font-size: 1.4em;
      color: var(--text-light);
      max-width: 700px;
      margin: 0 auto;
      font-weight: 400;
    }

    /* Sections */
    .section {
      padding: 60px 20px;
      max-width: 1100px;
      margin: 0 auto;
    }
    .section h2, .section h3 {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 30px;
      font-size: 2.5em;
      font-weight: 700;
      position: relative;
    }
    .section h2::after, .section h3::after {
        content: '';
        display: block;
        width: 80px;
        height: 4px;
        background: var(--secondary-color);
        margin: 15px auto 0;
        border-radius: 2px;
    }
    .section p {
        font-size: 1.1em;
        margin-bottom: 1.5em;
        color: var(--text-light);
    }
    .section ul {
        list-style: none;
        padding-left: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }
    .section ul li {
        background: var(--bg-white);
        padding: 15px 25px;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 15px var(--shadow-light);
        font-size: 1.15em;
        color: var(--text-dark);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: transform 0.3s ease;
    }
    .section ul li:hover {
        transform: translateY(-5px);
    }
    .section ul li img { /* For icons in lists */
        height: 30px;
        width: 30px;
    }
    .section img { /* General images within sections */
      display: block;
      margin: 0 auto 30px;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px var(--shadow-light);
    }

    /* Cards */
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 30px;
    }
    .card {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      box-shadow: 0 6px 20px var(--shadow-light);
      padding: 30px;
      width: 300px;
      text-align: center;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }
    .card img {
      width: 80px; /* Bigger icons for cards */
      height: 80px;
      margin-bottom: 20px;
      transition: transform 0.3s ease;
    }
    .card:hover img {
        transform: scale(1.1);
    }
    .card h3 {
      font-size: 1.8em;
      color: var(--primary-color);
      margin-bottom: 15px;
      font-weight: 700;
    }
    .card p {
      font-size: 1em;
      color: var(--text-light);
      line-height: 1.6;
    }
    .clickable-card {
      cursor: pointer;
    }
    .card-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(63, 104, 162, 0.95); /* Usar --primary-color con opacidad */
      color: var(--bg-white);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      font-weight: 600;
      font-size: 1.5em;
      border-radius: var(--border-radius);
    }
    .clickable-card:hover .card-overlay {
      opacity: 1;
    }

    /* Subject Pages */
    .subject-page {
      display: none;
      padding: 40px 20px;
    }
    .subject-page.active {
      display: block;
    }
    .back-button {
      background: var(--secondary-color);
      color: var(--bg-white);
      border: none;
      padding: 12px 25px;
      border-radius: var(--border-radius);
      cursor: pointer;
      margin-bottom: 30px;
      font-size: 1.1em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      display: inline-block; /* Para que margin-bottom funcione mejor */
    }
    .back-button:hover {
      background: var(--primary-color);
      transform: translateY(-2px);
    }
    .subject-page h1 {
      text-align: center;
      color: var(--primary-color);
      font-size: 3em;
      margin-bottom: 40px;
      font-weight: 700;
    }
    .subject-page .topic-list {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 4px 15px var(--shadow-light);
    }
    .subject-page .topic-list h2 {
      text-align: center;
      color: var(--text-dark);
      margin-bottom: 25px;
      font-size: 2em;
      font-weight: 600;
    }
    .topic-item {
      background: #fdfdfd; /* Blanco más claro */
      margin: 15px 0;
      padding: 20px;
      border-radius: var(--border-radius);
      border-left: 5px solid var(--secondary-color);
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
    }
    .topic-item:hover {
      background: #eef5fb; /* Ligeramente azulado al hover */
      transform: translateX(8px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .topic-title {
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 8px;
      font-size: 1.25em;
      display: flex;
      align-items: center;
      justify-content: space-between; /* Para alinear el badge y el indicador de progreso */
    }
    .topic-description {
      color: var(--text-light);
      font-size: 0.95em;
    }
    .level-badge {
      display: inline-block;
      background: var(--accent-color);
      color: var(--bg-white);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      margin-left: 15px;
      font-weight: 600;
    }
    .progress-indicator {
      font-size: 0.9em;
      font-weight: 600;
      color: green;
      margin-left: auto; /* Empuja el indicador a la derecha */
    }

    /* Contact Form */
    .contact-form {
      text-align: center;
      background: var(--bg-white);
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px var(--shadow-light);
      max-width: 700px;
      margin: 0 auto;
    }
    .contact-form p {
      font-size: 1.1em;
      margin-bottom: 25px;
      color: var(--text-dark);
    }
    .contact-form input,
    .contact-form textarea {
      width: calc(100% - 40px); /* Ajuste para padding */
      padding: 15px 20px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1.1em;
      color: var(--text-dark);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .contact-form input:focus,
    .contact-form textarea:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(63, 104, 162, 0.2);
      outline: none;
    }
    .contact-form button {
      background: var(--primary-color);
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.2em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      margin-top: 20px;
    }
    .contact-form button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
    }

    /* Footer */
    footer {
      background: var(--primary-color);
      color: white;
      text-align: center;
      padding: 25px;
      margin-top: 50px;
      font-size: 0.95em;
    }

    /* Quiz Styles */
    #quiz-container {
      background: var(--bg-white);
      max-width: 550px;
      margin: 60px auto;
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 8px 25px var(--shadow-light);
      display: none; /* Hidden by default, shown by JS */
    }
    #quiz-container h2 {
      color: var(--primary-color);
      margin-bottom: 30px;
      text-align: center;
      font-size: 2.2em;
      font-weight: 700;
    }
    .question {
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 1.3em;
      color: var(--text-dark);
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .options button {
      width: 100%;
      padding: 15px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.1em;
      transition: background 0.3s ease, transform 0.2s ease;
      text-align: left;
    }
    .options button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
    }
    /* Updated hidden utility class */
    .hidden {
      display: none !important; /* Added !important to ensure override */
    }
    /* Result Styles */
    #result-message {
      font-weight: 700;
      text-align: center;
      margin-bottom: 1.5rem;
      color: var(--primary-color);
      font-size: 1.5em;
      background: #eef5fb;
      padding: 15px;
      border-radius: var(--border-radius);
      border-left: 5px solid var(--secondary-color);
    }
    /* ADHD Recommendations */
    #tdah-warning {
      margin-top: 2.5rem;
      padding: 1.5rem;
      background-color: #ffe0b2; /* Tono naranja suave */
      border-radius: var(--border-radius);
      color: #b35900;
      font-weight: 600;
      max-width: 750px;
      margin-left: auto;
      margin-right: auto;
      border-left: 5px solid var(--accent-color);
      font-size: 1.1em;
    }
    #study-advice {
      max-width: 750px;
      margin: 0 auto 2rem auto;
      font-weight: 600;
      color: var(--text-dark);
      padding: 1.5rem;
      background: var(--bg-white);
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      border-left: 5px solid var(--primary-color);
      font-size: 1.1em;
    }

    /* Progress Bar Styles */
    .progress-bar-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: var(--border-radius);
      overflow: hidden;
      margin-bottom: 25px;
      height: 30px;
      position: relative;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    .progress-bar-fill {
      height: 100%;
      background-color: var(--secondary-color); /* Green color for progress */
      width: 0%; /* Will be updated by JS */
      border-radius: var(--border-radius) 0 0 var(--border-radius);
      transition: width 0.5s ease-in-out;
    }
    .progress-text {
      position: absolute;
      width: 100%;
      text-align: center;
      line-height: 30px;
      color: var(--text-dark);
      font-weight: 600;
      font-size: 1em;
    }

    /* Lesson Content Display */
    #lesson-content-display {
        background: var(--bg-white);
        max-width: 900px;
        margin: 60px auto;
        padding: 40px;
        border-radius: var(--border-radius);
        box-shadow: 0 8px 25px var(--shadow-light);
        min-height: 500px; /* Para que no se vea vacío */
        display: none; /* Initially hidden */
    }
    #lesson-content-display.active {
        display: block;
    }
    #lesson-content-display h2 {
        text-align: center;
        color: var(--primary-color);
        margin-bottom: 30px;
        font-size: 2.2em;
        font-weight: 700;
    }
    #lesson-material p {
        font-size: 1.1em;
        margin-bottom: 1.5em;
        color: var(--text-light);
    }
    #lesson-material video,
    #lesson-material audio,
    #lesson-material img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 25px auto;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    #lesson-material textarea {
        width: calc(100% - 40px);
        padding: 15px 20px;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        font-family: 'Poppins', sans-serif;
        font-size: 1em;
        min-height: 120px;
        margin-top: 15px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }
    #lesson-material .interactive-game-placeholder {
        background-color: #eef5fb; /* Tono azul claro */
        border: 2px dashed var(--secondary-color);
        padding: 60px;
        text-align: center;
        font-style: italic;
        color: var(--text-light);
        border-radius: var(--border-radius);
        margin: 30px 0;
        font-size: 1.2em;
    }
    #lesson-material button {
        background: var(--accent-color);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 1.1em;
        font-weight: 600;
        transition: background 0.3s ease, transform 0.2s ease;
        margin-top: 20px;
    }
    #lesson-material button:hover {
        background: #e67e22; /* Tono más oscuro de naranja */
        transform: translateY(-2px);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2em;
      }
      header .logo-container img {
        height: 60px;
      }
      .hero h1 {
        font-size: 2.5em;
      }
      .hero p {
        font-size: 1em;
      }
      nav {
        flex-direction: column;
        align-items: center;
        padding: 10px;
      }
      nav a {
        margin: 5px 0;
        font-size: 1em;
      }
      .section h2, .section h3 {
        font-size: 2em;
      }
      .cards, .testimonials-grid {
        flex-direction: column;
        align-items: center;
      }
      .card, .testimonial-card {
        width: 90%;
        max-width: 350px;
      }
      .contact-form input,
      .contact-form textarea {
        width: calc(100% - 20px);
        padding: 12px 10px;
      }
      #quiz-container, #lesson-content-display, .auth-form {
        margin: 30px auto;
        padding: 25px;
      }
      .question {
        font-size: 1.1em;
      }
    }
  </style>
</head>
<body>

  <div id="auth-forms-container" class="auth-container">
    <h2>Registro</h2>
    <form id="form-register" class="auth-form">
      <input type="email" name="email" placeholder="Correo electrónico" required />
      <input type="password" name="password" placeholder="Contraseña" required />
      <button type="submit">Registrarse</button>
    </form>

    <h2>Inicio de Sesión</h2>
    <form id="form-login" class="auth-form">
      <input type="email" name="email" placeholder="Correo electrónico" required />
      <input type="password" name="password" placeholder="Contraseña" required />
      <button type="submit">Iniciar sesión</button>
    </form>
  </div>

  <button id="logout-button" class="hidden">Cerrar Sesión</button>

  <div id="quiz-container" class="hidden">
    <h2>Cuestionario de Estilo de Aprendizaje</h2>
    <div id="question-text" class="question"></div>
    <div id="options" class="options"></div>
  </div>

  <div id="content-after-auth" class="hidden">
    <header>
      <div class="logo-container">
        <img src="Blue Modern Brain Genius And Technology Smart Mind Business Logo Template.png" alt="MultiGenio Logo" />
        <h1>MultiGenio</h1>
      </div>
      <p>Tu aliado en el aprendizaje</p>
    </header>

    <nav>
      <a href="#que-es">¿Qué es?</a>
      <a href="#materias">Materias</a>
      <a href="#beneficios">Beneficios</a>
      <a href="#testimonios">Testimonios</a>
      <a href="#contacto">Contacto</a>
    </nav>

    <section class="hero">
      <h1>Tu tutor virtual inteligente para Matemáticas, Inglés y Lengua</h1>
      <p>Un método de aprendizaje dinámico, adaptado a tu ritmo y estilo, diseñado para potenciar tu concentración y comprensión.</p>
    </section>

    <div id="result-message"></div>
    <div id="study-advice"></div>
    <div id="tdah-warning" class="hidden">
      ⚠️ Si presentas indicios de TDAH, MultiGenio te ofrecerá recursos y estrategias especiales para ayudarte a mantener la concentración y aprovechar tu estilo de aprendizaje de la forma más efectiva.
    </div>

    <section class="section" id="que-es">
      <h2>¿Qué es MultiGenio?</h2>
      <img src="https://img.icons8.com/color/96/online-support.png" alt="Estudio interactivo" style="width: 100px; height: 100px;"/>
      <p>
        <strong>MultiGenio</strong> es una plataforma educativa innovadora que revoluciona el aprendizaje, especialmente diseñada para estudiantes con **TDAH**, dificultades de atención o aquellos que buscan un método de estudio verdaderamente personalizado. A través de la integración de **Inteligencia Artificial Avanzada**, MultiGenio no solo se adapta al ritmo del alumno, sino que moldea activamente la experiencia educativa para maximizar la absorción del conocimiento y el mantenimiento del interés.
      </p>

      <h3>🧠 La Inteligencia Artificial en Acción: Un Enfoque Adaptativo</h3>
      <img src="https://img.icons8.com/color/96/artificial-intelligence.png" alt="Inteligencia Artificial" style="width: 100px; height: 100px;"/>
      <p>
        Nuestra IA propietaria va más allá de un simple algoritmo. Analiza patrones de respuesta en el cuestionario inicial, el progreso en los juegos interactivos, el tiempo dedicado a cada tema y las preferencias de material (visual, auditivo, etc.). Con estos datos, el sistema ajusta dinámicamente la dificultad de los ejercicios, prioriza ciertos tipos de contenido y sugiere rutas de aprendizaje alternativas. Por ejemplo, si un estudiante visual tiene dificultades con un concepto, la IA podría recomendar un video explicativo animado o un mapa mental interactivo antes de ofrecer otro tipo de ejercicio. Para alumnos con TDAH, la IA puede fragmentar lecciones extensas en módulos más cortos, incorporar micro-descansos activos o activar alertas visuales/auditivas sutiles para refocus.
      </p>
      <p>
        El objetivo es crear un "tutor virtual" que comprende las fortalezas y desafíos individuales, proporcionando una experiencia educativa que se siente hecha a la medida, minimizando las distracciones y potenciando la concentración.
      </p>

      <h2>📋 Cuestionario Inicial: Tu Huella de Aprendizaje</h2>
      <img src="https://img.icons8.com/color/96/quiz.png" alt="Cuestionario" style="width: 100px; height: 100px;"/>
      <p>
        Antes de sumergirte en el aprendizaje, MultiGenio te invita a un **cuestionario interactivo y estratégico de 5 preguntas**. Este no es un simple test; es una herramienta clave para nuestra IA. Las preguntas están cuidadosamente diseñadas para identificar tu estilo de aprendizaje predominante entre:
      </p>
      <ul>
        <li><img src="https://img.icons8.com/color/48/eye.png" alt="Visual icon"/> <strong>Visual:</strong> Aprendes mejor viendo imágenes, gráficos, diagramas y videos.</li>
        <li><img src="https://img.icons8.com/color/48/ear.png" alt="Auditivo icon"/> <strong>Auditivo:</strong> Retienes información escuchando explicaciones, debates o audios.</li>
        <li><img src="https://img.icons8.com/color/48/writing.png" alt="Lectura/Escritura icon"/> <strong>Lectura/Escritura:</strong> Tu fuerza está en leer textos, tomar notas y escribir resúmenes.</li>
        <li><img src="https://img.icons8.com/color/48/running.png" alt="Kinestésico icon"/> <strong>Kinestésico:</strong> Necesitas "hacer" para aprender; prefieres actividades prácticas y movimiento.</li>
      </ul>
      <p>
        Además, una de las preguntas está formulada para detectar indicios que podrían ser compatibles con TDAH. Si se identifican estas señales, la plataforma activará un conjunto de estrategias pedagógicas y recursos especiales, como temporizadores de foco, desafíos de atención y formatos de contenido adaptados, para asegurar una experiencia de aprendizaje óptima y libre de frustraciones. Este perfil inicial es la base sobre la cual la IA personaliza cada aspecto de tu trayectoria en MultiGenio.
      </p>
    </section>
    
    <section class="section" id="materias">
      <h2>Materias que puedes aprender</h2>
      <div class="cards">
        <div class="card clickable-card" onclick="showSubject('matematicas')">
          <img src="https://img.icons8.com/color/96/calculator.png" alt="Matemáticas" />
          <h3>Matemáticas</h3>
          <p>Desde sumas y divisiones hasta álgebra de 3º de ESO. Todo con juegos mentales, visuales y lógica adaptada a ti.</p>
          <div class="card-overlay">
            <span>¡Haz clic para empezar!</span>
          </div>
        </div>
        <div class="card clickable-card" onclick="showSubject('lengua')">
          <img src="https://img.icons8.com/color/96/book.png" alt="Lengua" />
          <h3>Lengua</h3>
          <p>Domina la morfología, sintaxis y reglas ortográficas con ejemplos creativos y prácticas fáciles de recordar.</p>
          <div class="card-overlay">
            <span>¡Haz clic para empezar!</span>
          </div>
        </div>
        <div class="card clickable-card" onclick="showSubject('ingles')">
          <img src="https://img.icons8.com/color/96/usa.png" alt="Inglés" />
          <h3>Inglés</h3>
          <p>Aprende desde A1 hasta B1: vocabulario, gramática, listening y speaking. Con apoyo visual y audios.</p>
          <div class="card-overlay">
            <span>¡Haz clic para empezar!</span>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="beneficios">
      <h2>¿Por qué elegir MultiGenio?</h2>
      <ul>
        <li><img src="https://img.icons8.com/color/48/star--v1.png" alt="Star icon"/> Explicaciones adaptadas a estudiantes con TDA/TDAH</li>
        <li><img src="https://img.icons8.com/color/48/video-camera.png" alt="Video icon"/> Videos, ejemplos y contenido creativo</li>
        <li><img src="https://img.icons8.com/color/48/brain.png" alt="Brain icon"/> Aprende a tu propio ritmo, sin presión</li>
        <li><img src="https://img.icons8.com/color/48/graduation-cap.png" alt="Graduation cap icon"/> Ideal para padres, docentes y alumnos</li>
      </ul>
    </section>

    <section class="section" id="testimonios">
      <h2>Lo que dicen nuestros alumnos</h2>
      <div class="cards testimonials-grid">
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/student-male.png" alt="Estudiante 1" />
          <h3>Laura G.</h3>
          <p>"¡MultiGenio cambió mi forma de ver las matemáticas! Siempre me frustraba, pero con sus explicaciones visuales y los juegos interactivos, ahora entiendo todo mucho mejor. ¡Recomendadísimo!"</p>
          <div class="rating">⭐⭐⭐⭐⭐</div>
        </div>
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/student-female.png" alt="Estudiante 2" />
          <h3>Pablo R.</h3>
          <p>"Como padre de un niño con TDAH, encontrar MultiGenio ha sido una bendición. La paciencia y el enfoque adaptado de la plataforma son increíbles. Mi hijo está motivado y aprendiendo sin estrés."</p>
          <div class="rating">⭐⭐⭐⭐⭐</div>
        </div>
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/teacher.png" alt="Estudiante 3" />
          <h3>Sofía M. (Profesora)</h3>
          <p>"He probado muchas herramientas, pero MultiGenio es única por su capacidad de adaptación. La IA es una maravilla para detectar y apoyar a cada alumno según su estilo. La recomiendo a todos mis colegas."</p>
          <div class="rating">⭐⭐⭐⭐⭐</div>
        </div>
      </div>
    </section>

    <section class="section" id="contacto">
      <h2>Contacto</h2>
      <div class="contact-form">
        <p>¿Quieres probar MultiGenio o tienes dudas? Envíanos un mensaje:</p>
        <form>
          <input type="text" placeholder="Tu nombre" required /><br />
          <input type="email" placeholder="Tu correo electrónico" required /><br />
          <textarea placeholder="Tu mensaje..." rows="5" required></textarea><br />
          <button type="submit">Enviar mensaje</button>
        </form>
      </div>
    </section>

    <script>
      window.chatbaseConfig = {
        chatbotId: "frw3UKvg6MK3c9Zw-bZAu"
      };
    </script>
    <script src="https://www.chatbase.co/embed.min.js" defer></script>

    <footer>
      <p>&copy; 2025 MultiGenio. Todos los derechos reservados.</p>
    </footer>
  </div>

  <div id="matematicas-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">← Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">📊 Matemáticas</h1>
      <div id="math-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="matematicas-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="matematicas-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'operaciones-basicas')">
          <div class="topic-title">Operaciones Básicas <span class="level-badge">Primaria</span>
            <span class="progress-indicator" id="progress-matematicas-operaciones-basicas"></span>
          </div>
          <div class="topic-description">Suma, resta, multiplicación y división. Problemas prácticos del día a día.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'fracciones')">
          <div class="topic-title">Fracciones y Decimales <span class="level-badge">6º Primaria</span>
            <span class="progress-indicator" id="progress-matematicas-fracciones"></span>
          </div>
          <div class="topic-description">Conceptos, operaciones y equivalencias. Con ejemplos visuales.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'porcentajes')">
          <div class="topic-title">Porcentajes <span class="level-badge">1º ESO</span>
            <span class="progress-indicator" id="progress-matematicas-porcentajes"></span>
          </div>
          <div class="topic-description">Cálculo de porcentajes, aumentos y descuentos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'ecuaciones')">
          <div class="topic-title">Ecuaciones de Primer Grado <span class="level-badge">2º ESO</span>
            <span class="progress-indicator" id="progress-matematicas-ecuaciones"></span>
          </div>
          <div class="topic-description">Resolución paso a paso con métodos visuales.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'sistemas')">
          <div class="topic-title">Sistemas de Ecuaciones <span class="level-badge">3º ESO</span>
            <span class="progress-indicator" id="progress-matematicas-sistemas"></span>
          </div>
          <div class="topic-description">Métodos de sustitución, igualación y reducción.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'geometria')">
          <div class="topic-title">Geometría Básica <span class="level-badge">1º-2º ESO</span>
            <span class="progress-indicator" id="progress-matematicas-geometria"></span>
          </div>
          <div class="topic-description">Áreas, perímetros y volúmenes de figuras básicas.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="lengua-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">← Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">📚 Lengua Española</h1>
      <div id="lengua-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="lengua-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="lengua-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'ortografia-basica')">
          <div class="topic-title">Ortografía Básica <span class="level-badge">Primaria</span>
            <span class="progress-indicator" id="progress-lengua-ortografia-basica"></span>
          </div>
          <div class="topic-description">Acentuación, uso de b/v, g/j, h. Con ejercicios prácticos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'morfologia')">
          <div class="topic-title">Morfología <span class="level-badge">1º ESO</span>
            <span class="progress-indicator" id="progress-lengua-morfologia"></span>
          </div>
          <div class="topic-description">Categorías gramaticales: sustantivos, adjetivos, verbos, etc.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'sintaxis-simple')">
          <div class="topic-title">Sintaxis - Oración Simple <span class="level-badge">2º ESO</span>
            <span class="progress-indicator" id="progress-lengua-sintaxis-simple"></span>
          </div>
          <div class="topic-description">Sujeto, predicado y complementos básicos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'sintaxis-compuesta')">
          <div class="topic-title">Sintaxis - Oración Compuesta <span class="level-badge">3º ESO</span>
            <span class="progress-indicator" id="progress-lengua-sintaxis-compuesta"></span>
          </div>
          <div class="topic-description">Oraciones coordinadas y subordinadas.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'literatura')">
          <div class="topic-title">Literatura Española <span class="level-badge">2º-3º ESO</span>
            <span class="progress-indicator" id="progress-lengua-literatura"></span>
          </div>
          <div class="topic-description">Géneros literarios, figuras retóricas y autores clave.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="ingles-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">← Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">🇬🇧 Inglés</h1>
      <div id="ingles-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="ingles-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="ingles-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'basico')">
          <div class="topic-title">Inglés Básico (A1) <span class="level-badge">Principiante</span>
            <span class="progress-indicator" id="progress-ingles-basico"></span>
          </div>
          <div class="topic-description">Saludos, números, vocabulario esencial, verbos básicos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'present-simple')">
          <div class="topic-title">Present Simple y Continuo <span class="level-badge">A2</span>
            <span class="progress-indicator" id="progress-ingles-present-simple"></span>
          </div>
          <div class="topic-description">Uso, estructura y ejercicios.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'past-tenses')">
          <div class="topic-title">Past Simple y Past Continuous <span class="level-badge">A2</span>
            <span class="progress-indicator" id="progress-ingles-past-tenses"></span>
          </div>
          <div class="topic-description">Narrar eventos pasados, diferencias clave.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'future-forms')">
          <div class="topic-title">Future Forms (Will, Going to) <span class="level-badge">B1</span>
            <span class="progress-indicator" id="progress-ingles-future-forms"></span>
          </div>
          <div class="topic-description">Expresar el futuro: predicciones, planes y decisiones.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'listening-speaking')">
          <div class="topic-title">Listening y Speaking <span class="level-badge">A2-B1</span>
            <span class="progress-indicator" id="progress-ingles-listening-speaking"></span>
          </div>
          <div class="topic-description">Ejercicios de comprensión oral y práctica de conversación.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="lesson-content-display" class="hidden">
    <div class="section">
      <button class="back-button" onclick="hideLessonContent()">← Volver al Temario</button>
      <h2 id="lesson-title"></h2>
      <div id="lesson-material">
        </div>
    </div>
  </div>

  <script type="module">
    // NUEVO: Importar las funciones de Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-analytics.js";
    import { 
      getAuth, 
      createUserWithEmailAndPassword, 
      signInWithEmailAndPassword, 
      onAuthStateChanged,
      signOut // Importar signOut para cerrar sesión
    } from "https://www.gstatic.com/firebasejs/11.9.0/firebase-auth.js";

    // NUEVO: Configuración de Firebase (asegúrate de que esta configuración es correcta)
    const firebaseConfig = {
      apiKey: "AIzaSyDklyhhZOV3c2KbbrvAZOpoUitPBWgRBOQ",
      authDomain: "multigenio-39890.firebaseapp.com",
      projectId: "multigenio-39890",
      storageBucket: "multigenio-39890.firebasestorage.app",
      messagingSenderId: "881137429405",
      appId: "1:881137429405:web:9f061138bdf43b00dd5d74",
      measurementId: "G-9SQX18GVH6"
    };

    // NUEVO: Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);

    // --- Elementos del DOM ---
    // NUEVO: Referencias a los nuevos contenedores de autenticación
    const authFormsContainer = document.getElementById('auth-forms-container');
    const formRegister = document.getElementById("form-register");
    const formLogin = document.getElementById("form-login");
    const logoutButton = document.getElementById("logout-button");
    const quizContainer = document.getElementById('quiz-container');
    const contentAfterAuth = document.getElementById('content-after-auth'); // NUEVO: Contenedor para el contenido principal
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options');
    const resultMessage = document.getElementById('result-message');
    const studyAdvice = document.getElementById('study-advice');
    const tdahWarning = document.getElementById('tdah-warning');
    const lessonContentDisplay = document.getElementById('lesson-content-display');
    const lessonTitle = document.getElementById('lesson-title');
    const lessonMaterial = document.getElementById('lesson-material');

    // --- Variables de Estado ---
    let currentQuestionIndex = 0;
    let learningProfile = {
      visual: 0,
      auditory: 0,
      readingWriting: 0,
      kinesthetic: 0,
      tdahScore: 0
    };
    let userLearningProfile = null; // Almacenará el perfil final del usuario
    let tdahIndication = false;

    // Estructura de datos para el progreso del usuario
    let userProgress = JSON.parse(localStorage.getItem('userProgress')) || {
      matematicas: {},
      lengua: {},
      ingles: {}
    };

    // Objeto que contiene las lecciones para cada materia y tema
    const lessons = {
      matematicas: {
        'operaciones-basicas': {
          title: 'Introducción a las Operaciones Básicas',
          content: `
            <p>Las operaciones básicas en matemáticas son la base de todo. Sumar es unir cantidades, restar es quitar, multiplicar es sumar varias veces la misma cantidad y dividir es repartir en partes iguales.</p>
            <p><strong>Ejemplo Visual (si el perfil es visual):</strong></p>
            <img src="https://img.icons8.com/color/96/add.png" alt="Suma" style="width: 50px; height: 50px; display: inline-block; vertical-align: middle;"> + 
            <img src="https://img.icons8.com/color/96/add.png" alt="Suma" style="width: 50px; height: 50px; display: inline-block; vertical-align: middle;"> = 
            <img src="https://img.icons8.com/color/96/add.png" alt="Suma" style="width: 50px; height: 50px; display: inline-block; vertical-align: middle;"> + 
            <img src="https://img.icons8.com/color/96/add.png" alt="Suma" style="width: 50px; height: 50px; display: inline-block; vertical-align: middle;"><br>
            <small>Esto representa 2 + 2 = 4</small>
            <p><strong>Ejemplo Auditivo (si el perfil es auditivo):</strong></p>
            <audio controls src="ejemplo_suma.mp3">Tu navegador no soporta el elemento de audio.</audio>
            <p>Escucha cómo explicamos la suma y la resta con ejemplos.</p>
            <p><strong>Ejemplo Lectura/Escritura (si el perfil es lectura/escritura):</strong></p>
            <p>Para practicar, intenta resolver:</p>
            <ul>
              <li>5 + 3 = ?</li>
              <li>10 - 4 = ?</li>
              <li>2 * 6 = ?</li>
              <li>12 / 3 = ?</li>
            </ul>
            <p><strong>Ejemplo Kinestésico (si el perfil es kinestésico):</strong></p>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Construye el Resultado! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'operaciones-basicas')">Jugar Ahora</button>
            </div>
            <p>Escribe aquí tu resumen de la lección:</p>
            <textarea placeholder="Escribe tu resumen aquí..."></textarea>
            <button onclick="saveLessonProgress('matematicas', 'operaciones-basicas')">Marcar como completado</button>
          `
        },
        'fracciones': {
          title: 'Concepto de Fracciones y Decimales',
          content: `
            <p>Las fracciones representan partes de un todo, y los decimales son otra forma de expresar esas partes.</p>
            <p>Si eres visual, imagina un pastel dividido en partes iguales.</p>
            <img src="https://via.placeholder.com/300x200?text=Pastel+de+Fracciones" alt="Fracciones de pastel">
            <p>Si eres auditivo, escucha esta breve explicación de fracciones:</p>
            <audio controls src="ejemplo_fracciones.mp3">Tu navegador no soporta el elemento de audio.</audio>
            <p>Para la práctica de lectura/escritura, define qué es una fracción y un decimal con tus propias palabras.</p>
            <textarea placeholder="Tu definición..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Empareja Fracciones y Decimales! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'fracciones')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('matematicas', 'fracciones')">Marcar como completado</button>
          `
        },
        'porcentajes': {
          title: 'Cálculo y Aplicación de Porcentajes',
          content: `
            <p>Los porcentajes son una forma de expresar una parte de un total como una fracción de 100.</p>
            <p><strong>Visual:</strong> Gráfico de barras o circular para ver el 10% vs el 50%.</p>
            <img src="https://via.placeholder.com/300x200?text=Grafico+Porcentajes" alt="Gráfico de porcentajes">
            <p><strong>Auditivo:</strong> Escucha ejemplos de porcentajes en la vida real (descuentos, impuestos).</p>
            <audio controls src="ejemplo_porcentajes.mp3">Tu navegador no soporta el elemento de audio.</audio>
            <p><strong>Lectura/Escritura:</strong> Calcula el 20% de 150.</p>
            <textarea placeholder="Tu cálculo..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Resuelve Problemas de Porcentajes! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'porcentajes')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('matematicas', 'porcentajes')">Marcar como completado</button>
          `
        },
        'ecuaciones': {
          title: 'Ecuaciones de Primer Grado',
          content: `
            <p>Una ecuación de primer grado es una igualdad con una o varias incógnitas que solo tienen un valor. Aprenderás a "despejar" la incógnita.</p>
            <p><strong>Visual:</strong> Usa una balanza para representar la igualdad.</p>
            <img src="https://via.placeholder.com/300x200?text=Balanza+Ecuaciones" alt="Balanza de ecuaciones">
            <p><strong>Lectura/Escritura:</strong> Resuelve: $2x + 5 = 15$</p>
            <textarea placeholder="Tu resolución..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Encuentra la X! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'ecuaciones')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('matematicas', 'ecuaciones')">Marcar como completado</button>
          `
        },
        'sistemas': {
          title: 'Sistemas de Ecuaciones Lineales',
          content: `
            <p>Un sistema de ecuaciones es un conjunto de dos o más ecuaciones con varias incógnitas que deben satisfacerse simultáneamente.</p>
            <p><strong>Visual:</strong> Gráficos de líneas que se cruzan para representar la solución.</p>
            <img src="https://via.placeholder.com/300x200?text=Grafico+Sistemas" alt="Gráfico de sistemas de ecuaciones">
            <p><strong>Lectura/Escritura:</strong> Explica el método de sustitución.</p>
            <textarea placeholder="Tu explicación..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Solucionador de Sistemas! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'sistemas')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('matematicas', 'sistemas')">Marcar como completado</button>
          `
        },
        'geometria': {
          title: 'Introducción a la Geometría Básica',
          content: `
            <p>La geometría es el estudio de las formas, tamaños, posiciones relativas de las figuras y las propiedades del espacio.</p>
            <p><strong>Visual:</strong> Muestra formas 2D y 3D con animaciones.</p>
            <video controls src="ejemplo_geometria.mp4">Tu navegador no soporta el video.</video>
            <p><strong>Kinestésico:</strong> Recorta formas de papel y calcula su área.</p>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Construye Figuras Geométricas! (Simulación)<br>
              <button onclick="simulateGameCompletion('matematicas', 'geometria')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('matematicas', 'geometria')">Marcar como completado</button>
          `
        }
      },
      lengua: {
        'ortografia-basica': {
          title: 'Dominando la Ortografía Básica',
          content: `
            <p>La ortografía es clave para escribir bien. Aquí repasaremos las reglas más importantes de acentuación, uso de mayúsculas y algunas letras difíciles.</p>
            <p><strong>Visual:</strong> Infografía con reglas de acentuación.</p>
            <img src="https://via.placeholder.com/300x200?text=Reglas+Acentuacion" alt="Reglas de acentuación">
            <p><strong>Auditivo:</strong> Escucha palabras con tilde y sin tilde para diferenciar.</p>
            <audio controls src="ejemplo_acentos.mp3">Tu navegador no soporta el audio.</audio>
            <p><strong>Lectura/Escritura:</strong> Corrige los errores en el siguiente párrafo:</p>
            <textarea placeholder="Escribe el párrafo corregido aquí..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Caza Errores Ortográficos! (Simulación)<br>
              <button onclick="simulateGameCompletion('lengua', 'ortografia-basica')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('lengua', 'ortografia-basica')">Marcar como completado</button>
          `
        },
        'morfologia': {
          title: 'Explorando la Morfología',
          content: `
            <p>La morfología es el estudio de la estructura interna de las palabras y su formación. Aprenderás sobre sustantivos, adjetivos, verbos, adverbios, etc.</p>
            <p><strong>Visual:</strong> Diagramas de categorías gramaticales.</p>
            <img src="https://via.placeholder.com/300x200?text=Categorias+Gramaticales" alt="Categorías gramaticales">
            <p><strong>Kinestésico:</strong> Clasifica tarjetas con palabras en sus categorías.</p>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Clasificador de Palabras! (Simulación)<br>
              <button onclick="simulateGameCompletion('lengua', 'morfologia')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('lengua', 'morfologia')">Marcar como completado</button>
          `
        },
        'sintaxis-simple': {
          title: 'Sintaxis: La Oración Simple',
          content: `
            <p>La sintaxis estudia cómo se combinan las palabras para formar oraciones y cómo estas se estructuran. Empezaremos con el sujeto y el predicado.</p>
            <p><strong>Visual:</strong> Árboles sintácticos simplificados.</p>
            <img src="https://via.placeholder.com/300x200?text=Sintaxis+Simple" alt="Sintaxis de oración simple">
            <p><strong>Lectura/Escritura:</strong> Analiza sintácticamente la oración "El perro ladra fuerte".</p>
            <textarea placeholder="Tu análisis..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Arma la Oración! (Simulación)<br>
              <button onclick="simulateGameCompletion('lengua', 'sintaxis-simple')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('lengua', 'sintaxis-simple')">Marcar como completado</button>
          `
        },
        'sintaxis-compuesta': {
          title: 'Sintaxis: La Oración Compuesta',
          content: `
            <p>Las oraciones compuestas son aquellas que tienen más de un verbo. Aprenderás sobre las coordinadas (unidas por "y", "o", "pero") y las subordinadas (dependen de otra oración).</p>
            <p><strong>Visual:</strong> Diagramas de flujo para identificar tipos de oraciones compuestas.</p>
            <img src="https://via.placeholder.com/300x200?text=Sintaxis+Compuesta" alt="Sintaxis de oración compuesta">
            <p><strong>Auditivo:</strong> Escucha ejemplos de oraciones coordinadas y subordinadas.</p>
            <audio controls src="ejemplo_compuestas.mp3">Tu navegador no soporta el audio.</audio>
            <p><strong>Lectura/Escritura:</strong> Identifica el tipo de oración en "Comió y luego durmió".</p>
            <textarea placeholder="Tu respuesta..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Conectando Oraciones! (Simulación)<br>
              <button onclick="simulateGameCompletion('lengua', 'sintaxis-compuesta')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('lengua', 'sintaxis-compuesta')">Marcar como completado</button>
          `
        },
        'literatura': {
          title: 'Introducción a la Literatura Española',
          content: `
            <p>Exploraremos los géneros literarios (narrativa, poesía, teatro) y algunos de los autores más importantes de la literatura española.</p>
            <p><strong>Visual:</strong> Línea del tiempo de la literatura española con imágenes de autores.</p>
            <img src="https://via.placeholder.com/300x200?text=Linea+Literatura" alt="Línea del tiempo de la literatura">
            <p><strong>Auditivo:</strong> Fragmentos de obras literarias leídos en voz alta.</p>
            <audio controls src="ejemplo_literatura.mp3">Tu navegador no soporta el audio.</audio>
            <p><strong>Lectura/Escritura:</strong> Nombra un autor del Siglo de Oro y una de sus obras.</p>
            <textarea placeholder="Tu respuesta..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Quiz de Literatura! (Simulación)<br>
              <button onclick="simulateGameCompletion('lengua', 'literatura')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('lengua', 'literatura')">Marcar como completado</button>
          `
        }
      },
      ingles: {
        'basico': {
          title: 'Inglés Básico para Principiantes (A1)',
          content: `
            <p>Bienvenido al inglés! Empezaremos con saludos, presentaciones y vocabulario básico para que puedas comunicarte en situaciones sencillas.</p>
            <p><strong>Auditivo/Visual:</strong> Video con diálogos sencillos y pronunciación.</p>
            <video controls src="ejemplo_ingles_basico.mp4">Tu navegador no soporta el video.</video>
            <p><strong>Lectura/Escritura:</strong> Introduce tus datos personales en inglés:</p>
            <textarea placeholder="My name is..., I am from..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Une Palabras en Inglés! (Simulación)<br>
              <button onclick="simulateGameCompletion('ingles', 'basico')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('ingles', 'basico')">Marcar como completado</button>
          `
        },
        'present-simple': {
          title: 'Present Simple y Present Continuous',
          content: `
            <p>Aprende a hablar de hábitos y verdades generales con el Present Simple, y de acciones que están ocurriendo ahora con el Present Continuous.</p>
            <p><strong>Visual:</strong> Tablas comparativas de ambos tiempos verbales.</p>
            <img src="https://via.placeholder.com/300x200?text=Present+Tenses" alt="Tabla de tiempos verbales">
            <p><strong>Kinestésico:</strong> Escribe frases usando ambos tiempos y actúalas.</p>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Completa Frases! (Simulación)<br>
              <button onclick="simulateGameCompletion('ingles', 'present-simple')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('ingles', 'present-simple')">Marcar como completado</button>
          `
        },
        'past-tenses': {
          title: 'Past Simple y Past Continuous',
          content: `
            <p>Descubre cómo narrar eventos en el pasado usando el Past Simple para acciones terminadas y el Past Continuous para acciones en progreso en un momento específico.</p>
            <p><strong>Auditivo:</strong> Escucha una historia corta narrada en pasado.</p>
            <audio controls src="ejemplo_past_tenses.mp3">Tu navegador no soporta el audio.</audio>
            <p><strong>Lectura/Escritura:</strong> Describe tu día de ayer usando verbos en Past Simple.</p>
            <textarea placeholder="Yesterday I..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Ordena Eventos Pasados! (Simulación)<br>
              <button onclick="simulateGameCompletion('ingles', 'past-tenses')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('ingles', 'past-tenses')">Marcar como completado</button>
          `
        },
        'future-forms': {
          title: 'Future Forms: Will y Going to',
          content: `
            <p>Aprende a expresar el futuro en inglés. 'Will' para decisiones espontáneas y predicciones, 'Going to' para planes y predicciones con evidencia.</p>
            <p><strong>Visual:</strong> Ilustraciones que diferencian 'will' y 'going to'.</p>
            <img src="https://via.placeholder.com/300x200?text=Future+Forms" alt="Will vs Going To">
            <p><strong>Kinestésico:</strong> Prepara una lista de 5 planes usando 'going to' y 5 predicciones usando 'will' para el próximo mes.</p>
            <textarea placeholder="My plans for next month..."></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Elige el Futuro Correcto! (Simulación)<br>
              <button onclick="simulateGameCompletion('ingles', 'future-forms')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('ingles', 'future-forms')">Marcar como completado</button>
          `
        },
        'listening-speaking': {
          title: 'Desarrollo de Listening y Speaking',
          content: `
            <p>La clave para dominar el inglés es practicar la escucha y el habla. Aquí encontrarás ejercicios para mejorar tu comprensión oral y fluidez.</p>
            <p><strong>Auditivo:</strong> Diálogo con preguntas de comprensión.</p>
            <audio controls src="ejemplo_dialogo_ingles.mp3">Tu navegador no soporta el audio.</audio>
            <p><strong>Speaking (simulado):</strong> Graba un audio describiendo tu día en inglés.</p>
            <textarea placeholder="Start speaking here... (simulated recording)"></textarea>
            <div class="interactive-game-placeholder">
              ¡Juego Interactivo: Dictado en Inglés! (Simulación)<br>
              <button onclick="simulateGameCompletion('ingles', 'listening-speaking')">Jugar Ahora</button>
            </div>
            <button onclick="saveLessonProgress('ingles', 'listening-speaking')">Marcar como completado</button>
          `
        }
      }
    };


    // --- Preguntas del Cuestionario ---
    const questions = [
      {
        question: "¿Qué prefieres al aprender un tema nuevo?",
        options: [
          { text: "Ver videos explicativos o diagramas.", type: "visual" },
          { text: "Escuchar una explicación de un profesor o un podcast.", type: "auditory" },
          { text: "Leer un libro de texto o tomar apuntes detallados.", type: "readingWriting" },
          { text: "Hacer un experimento o una actividad práctica.", type: "kinesthetic" }
        ]
      },
      {
        question: "Cuando te dan instrucciones, ¿cómo las retienes mejor?",
        options: [
          { text: "Viendo un mapa o un esquema.", type: "visual" },
          { text: "Escuchando las instrucciones claramente.", type: "auditory" },
          { text: "Leyéndolas o escribiéndolas.", type: "readingWriting" },
          { text: "Siguiéndolas mientras las realizas.", type: "kinesthetic" }
        ]
      },
      {
        question: "¿Cómo te concentras mejor al estudiar?",
        options: [
          { text: "En un entorno tranquilo, con materiales visuales bien organizados.", type: "visual" },
          { text: "Escuchando música relajante o usando grabaciones de la lección.", type: "auditory" },
          { text: "Subrayando, resumiendo y reescribiendo la información.", type: "readingWriting" },
          { text: "Moviéndote, haciendo pausas activas o manipulando objetos.", type: "kinesthetic" }
        ]
      },
      {
        question: "¿Qué tipo de actividad de ocio disfrutas más?",
        options: [
          { text: "Ver películas, series o galerías de arte.", type: "visual" },
          { text: "Escuchar música, podcasts o participar en debates.", type: "auditory" },
          { text: "Leer libros, escribir diarios o participar en foros online.", type: "readingWriting" },
          { text: "Practicar deportes, cocinar o construir algo.", type: "kinesthetic" }
        ]
      },
      {
        question: "Al realizar una tarea larga, a veces me cuesta mantener el enfoque y me distraigo con facilidad. ¿Te identificas con esto?",
        options: [
          { text: "Sí, a menudo me pasa.", type: "tdah" },
          { text: "A veces, pero no siempre.", type: "tdah" },
          { text: "Raramente o nunca.", type: "none" }
        ]
      }
    ];

    // --- Funciones del Cuestionario ---
    function showQuestion() {
      if (currentQuestionIndex < questions.length) {
        const q = questions[currentQuestionIndex];
        questionText.textContent = q.question;
        optionsContainer.innerHTML = '';
        q.options.forEach(option => {
          const button = document.createElement('button');
          button.textContent = option.text;
          button.onclick = () => selectOption(option.type);
          optionsContainer.appendChild(button);
        });
      } else {
        showResults();
      }
    }

    function selectOption(type) {
      if (type === "tdah") {
        learningProfile.tdahScore++;
      } else if (type !== "none") {
        learningProfile[type]++;
      }
      currentQuestionIndex++;
      showQuestion();
    }

    function showResults() {
      quizContainer.classList.add('hidden');
      contentAfterAuth.classList.remove('hidden');

      const maxScore = Math.max(learningProfile.visual, learningProfile.auditory, learningProfile.readingWriting, learningProfile.kinesthetic);
      const dominantStyles = Object.keys(learningProfile).filter(
        style => style !== 'tdahScore' && learningProfile[style] === maxScore
      );

      if (dominantStyles.length > 0) {
        userLearningProfile = dominantStyles[0]; // Tomamos el primero si hay empate
      } else {
        userLearningProfile = 'readingWriting'; // Default si no se detecta nada (un caso raro)
      }

      tdahIndication = learningProfile.tdahScore >= 2; // Si responde "Sí" o "A veces" dos o más veces

      localStorage.setItem('userLearningProfile', userLearningProfile);
      localStorage.setItem('tdahIndication', tdahIndication);

      resultMessage.textContent = `Tu estilo de aprendizaje principal es: ${getStyleName(userLearningProfile)}.`;
      resultMessage.classList.remove('hidden');

      updateStudyAdvice(); // Actualizar el consejo de estudio
      if (tdahIndication) {
        tdahWarning.classList.remove('hidden');
      } else {
        tdahWarning.classList.add('hidden');
      }
    }

    function getStyleName(style) {
      switch (style) {
        case 'visual': return 'Visual';
        case 'auditory': return 'Auditivo';
        case 'readingWriting': return 'Lectura/Escritura';
        case 'kinesthetic': return 'Kinestésico';
        default: return 'No definido';
      }
    }

    function updateStudyAdvice() {
      let advice = "Aquí tienes algunos consejos generales para estudiar mejor:";
      if (userLearningProfile) {
        switch (userLearningProfile) {
          case 'visual':
            advice = "Como aprendiz Visual, te recomendamos usar mapas mentales, diagramas, videos y colores en tus apuntes. Visualiza la información para recordarla mejor.";
            break;
          case 'auditory':
            advice = "Como aprendiz Auditivo, te beneficiarás de escuchar grabaciones, participar en debates, leer en voz alta y explicar los conceptos a otros.";
            break;
          case 'readingWriting':
            advice = "Como aprendiz de Lectura/Escritura, subraya, toma notas detalladas, haz resúmenes, escribe definiciones y crea flashcards.";
            break;
          case 'kinesthetic':
            advice = "Como aprendiz Kinestésico, te ayudará hacer experimentos, usar manipulables, moverte mientras estudias, hacer role-playing y tomar descansos activos.";
            break;
        }
      }
      studyAdvice.textContent = advice;
      studyAdvice.classList.remove('hidden');
    }

    // --- Funciones de Navegación y Vistas ---
    function hideAllSections() {
      // Oculta todas las secciones de la página principal y las páginas de asignatura
      document.querySelectorAll('.section').forEach(sec => sec.classList.add('hidden'));
      document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden'));
      quizContainer.classList.add('hidden');
      lessonContentDisplay.classList.add('hidden');
      // NUEVO: Oculta los formularios de autenticación
      authFormsContainer.classList.add('hidden');
      // NUEVO: Oculta el contenedor principal de la app
      contentAfterAuth.classList.add('hidden'); 
    }

    function showMainContent() {
      hideAllSections();
      contentAfterAuth.classList.remove('hidden');
      // Asegurarse de que los mensajes de resultado y TDAH se muestren si ya están establecidos
      if (localStorage.getItem('userLearningProfile')) {
        resultMessage.classList.remove('hidden');
        studyAdvice.classList.remove('hidden');
      } else {
         resultMessage.classList.add('hidden');
         studyAdvice.classList.add('hidden');
      }
      if (localStorage.getItem('tdahIndication') === 'true') {
        tdahWarning.classList.remove('hidden');
      } else {
        tdahWarning.classList.add('hidden');
      }
    }

    function showSubject(subjectId) {
      hideAllSections();
      document.getElementById(`${subjectId}-page`).classList.remove('hidden');
      document.getElementById(`${subjectId}-page`).classList.add('active'); // Mantener la clase active
      // Personalizar intro de la materia
      const introElement = document.getElementById(`${subjectId}-personalized-intro`);
      if (introElement && userLearningProfile) {
        introElement.innerHTML = `<p style="text-align: center; font-style: italic; color: var(--text-dark); font-size: 1.1em;">¡Hola! Tu estilo ${getStyleName(userLearningProfile)} es perfecto para esta materia. Aquí tienes el temario.</p>`;
      }
      updateProgressBars(); // Actualiza las barras de progreso al entrar en la materia
      // Guardar la página de asignatura activa en localStorage
      localStorage.setItem('activeSubjectPage', subjectId);
    }

    function showLessonContent(subject, topicId) {
        hideAllSections(); // Oculta todo, incluyendo el quiz y las páginas de asignatura
        lessonContentDisplay.classList.remove('hidden');
        lessonContentDisplay.classList.add('active'); // Activa la visualización de la lección

        lessonTitle.textContent = lessons[subject][topicId].title;
        lessonMaterial.innerHTML = lessons[subject][topicId].content;

        // Cargar el estado del progreso para esta lección
        const progressStatus = userProgress[subject][topicId];
        const completeButton = lessonMaterial.querySelector('button[onclick^="saveLessonProgress"]');
        if (completeButton) {
            if (progressStatus === 'completed') {
                completeButton.textContent = 'Lección Completada';
                completeButton.disabled = true;
                completeButton.style.backgroundColor = 'green';
            } else {
                completeButton.textContent = 'Marcar como completado';
                completeButton.disabled = false;
                completeButton.style.backgroundColor = 'var(--accent-color)';
            }
        }
        
        // Guardar la lección activa en localStorage
        localStorage.setItem('activeLesson', JSON.stringify({ subject: subject, topicId: topicId }));
    }

    function hideLessonContent() {
      lessonContentDisplay.classList.add('hidden');
      lessonContentDisplay.classList.remove('active');
      localStorage.removeItem('activeLesson'); // Eliminar la lección activa al salir
      // Volver a la página de la asignatura activa
      const previouslyActiveSubjectId = localStorage.getItem('activeSubjectPage');
      if (previouslyActiveSubjectId) {
          showSubject(previouslyActiveSubjectId);
      } else {
          showMainContent(); // Fallback si por alguna razón no hay asignatura activa
      }
    }

    // --- Funciones de Progreso ---
    function saveProgress(subject, topicId, status = 'completed') {
      if (!userProgress[subject]) {
        userProgress[subject] = {};
      }
      userProgress[subject][topicId] = status;
      localStorage.setItem('userProgress', JSON.stringify(userProgress));
      updateProgressBars();
      updateTopicProgressIndicator(subject, topicId);
    }

    function saveLessonProgress(subject, topicId) {
        saveProgress(subject, topicId, 'completed');
        alert('Lección marcada como completada. ¡Buen trabajo!');
        // Opcional: Volver automáticamente al temario de la materia o mostrar un mensaje
        hideLessonContent(); // Vuelve al temario de la materia
    }

    function loadProgress() {
      userProgress = JSON.parse(localStorage.getItem('userProgress')) || {
        matematicas: {},
        lengua: {},
        ingles: {}
      };
      // Actualizar los indicadores de progreso al cargar
      Object.keys(userProgress).forEach(subject => {
        // Asegúrate de que userProgress[subject] no sea null o undefined
        if (userProgress[subject]) { 
          Object.keys(userProgress[subject]).forEach(topicId => {
            updateTopicProgressIndicator(subject, topicId);
          });
        }
      });
      updateProgressBars();
    }

    function updateProgressBars() {
      const subjects = ['matematicas', 'lengua', 'ingles'];
      subjects.forEach(subject => {
        const topicItems = document.querySelectorAll(`#${subject}-page .topic-item`);
        if (topicItems.length === 0) return; // No hay temas para esta materia

        let completedTopics = 0;
        topicItems.forEach(item => {
          const topicId = item.onclick.toString().match(/'[^']+'/g)[1].replace(/'/g, ''); // Extraer topicId del onclick
          if (userProgress[subject] && userProgress[subject][topicId] === 'completed') {
            completedTopics++;
          }
        });

        const percentage = (completedTopics / topicItems.length) * 100;
        const progressBarFill = document.getElementById(`${subject}-progress-fill`);
        const progressBarText = document.getElementById(`${subject}-progress-text`);

        if (progressBarFill && progressBarText) {
          progressBarFill.style.width = `${percentage}%`;
          progressBarText.textContent = `${Math.round(percentage)}% completado`;
        }
      });
    }

    function updateTopicProgressIndicator(subject, topicId) {
      const indicator = document.getElementById(`progress-${subject}-${topicId}`);
      if (indicator && userProgress[subject] && userProgress[subject][topicId] === 'completed') {
        indicator.textContent = '✅ Completado';
        indicator.style.color = 'green';
      } else if (indicator) {
        indicator.textContent = ''; // Limpiar si no está completado
      }
    }

    // NUEVO: --- Autenticación de Firebase ---

    // Función para registrar usuarios
    async function register(email, password) {
      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        alert(`Usuario registrado: ${userCredential.user.email}`);
        formRegister.reset();
        // Firebase onAuthStateChanged se encargará de ocultar los formularios y mostrar el contenido
      } catch (error) {
        alert(`Error en registro: ${error.message}`);
      }
    }

    // Función para iniciar sesión
    async function login(email, password) {
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        alert(`Usuario conectado: ${userCredential.user.email}`);
        formLogin.reset();
        // Firebase onAuthStateChanged se encargará de ocultar los formularios y mostrar el contenido
      } catch (error) {
        alert(`Error en inicio de sesión: ${error.message}`);
      }
    }

    // Función para cerrar sesión
    async function logout() {
      try {
        await signOut(auth);
        alert('Sesión cerrada.');
        // Limpiar el perfil de aprendizaje y el progreso de localStorage al cerrar sesión
        localStorage.removeItem('userLearningProfile');
        localStorage.removeItem('tdahIndication');
        localStorage.removeItem('userProgress');
        localStorage.removeItem('activeSubjectPage');
        localStorage.removeItem('activeLesson');
        userLearningProfile = null; // Reiniciar en memoria
        tdahIndication = false; // Reiniciar en memoria
        userProgress = { matematicas: {}, lengua: {}, ingles: {} }; // Resetear progreso en memoria
        // onAuthStateChanged se encargará de redirigir a la vista de login
      } catch (error) {
        alert(`Error al cerrar sesión: ${error.message}`);
      }
    }

    // Asociar eventos a los formularios
    formRegister.addEventListener("submit", e => {
      e.preventDefault();
      const email = formRegister.email.value;
      const password = formRegister.password.value;
      register(email, password);
    });

    formLogin.addEventListener("submit", e => {
      e.preventDefault();
      const email = formLogin.email.value;
      const password = formLogin.password.value;
      login(email, password);
    });

    logoutButton.addEventListener("click", logout);

    // NUEVO: --- Manejo del estado de autenticación ---
    onAuthStateChanged(auth, (user) => {
      if (user) {
        // Usuario autenticado
        authFormsContainer.classList.add('hidden');
        logoutButton.classList.remove('hidden'); // Mostrar botón de cerrar sesión
        
        // Cargar el perfil de aprendizaje del usuario y el progreso
        userLearningProfile = localStorage.getItem('userLearningProfile');
        tdahIndication = localStorage.getItem('tdahIndication') === 'true';
        loadProgress(); // Cargar progreso al iniciar sesión

        // Determinar qué mostrar: quiz o contenido principal
        if (!userLearningProfile) {
          // Si no hay perfil de aprendizaje, mostrar el quiz
          hideAllSections(); // Asegúrate de que todo esté oculto
          quizContainer.classList.remove('hidden');
          currentQuestionIndex = 0; // Reiniciar quiz si el usuario no tiene perfil
          learningProfile = { visual: 0, auditory: 0, readingWriting: 0, kinesthetic: 0, tdahScore: 0 };
          showQuestion();
        } else {
          // Si ya tiene perfil, mostrar el contenido principal o la última lección/materia
          const activeLesson = JSON.parse(localStorage.getItem('activeLesson'));
          const activeSubjectPage = localStorage.getItem('activeSubjectPage');

          if (activeLesson) {
              showLessonContent(activeLesson.subject, activeLesson.topicId);
          } else if (activeSubjectPage) {
              showSubject(activeSubjectPage);
          } else {
              showMainContent();
          }
        }
      } else {
        // Usuario no autenticado
        hideAllSections();
        authFormsContainer.classList.remove('hidden');
        logoutButton.classList.add('hidden'); // Ocultar botón de cerrar sesión
        // Asegurarse de que el quiz y el contenido principal estén ocultos
        quizContainer.classList.add('hidden');
        contentAfterAuth.classList.add('hidden');
      }
    });

    // Simular que un juego interactivo ha sido completado
    function simulateGameCompletion(subject, topicId) {
        alert('¡Felicidades! Has completado el juego interactivo. Tu progreso ha sido guardado.');
        saveProgress(subject, topicId, 'completed');
        hideLessonContent(); // Oculta el contenido de la lección y vuelve al temario
    }

    // NUEVO: Expone las funciones globales para que los onclick en el HTML funcionen
    window.showSubject = showSubject;
    window.showMainContent = showMainContent;
    window.showLessonContent = showLessonContent;
    window.hideLessonContent = hideLessonContent;
    window.saveLessonProgress = saveLessonProgress;
    window.simulateGameCompletion = simulateGameCompletion; // Expone la función de simulación
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MultiGenio - Tu aliado en el aprendizaje</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary-color: #3f68a2; /* Azul m√°s suave */
      --secondary-color: #6ed3b3; /* Azul verdoso del logo */
      --accent-color: #f39c12; /* Naranja para √©nfasis */
      --text-dark: #34495e;
      --text-light: #5e6c7d;
      --bg-light: #f8f9fa;
      --bg-white: #ffffff;
      --shadow-light: rgba(0, 0, 0, 0.08);
      --border-radius: 10px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-light);
      color: var(--text-light);
      line-height: 1.7;
    }

    /* Header */
    header {
      background: var(--primary-color);
      color: var(--bg-white);
      padding: 30px 20px;
      text-align: center;
      box-shadow: 0 2px 10px var(--shadow-light);
    }
    header .logo-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px; /* Espacio entre logo y texto */
      margin-bottom: 10px;
    }
    header .logo-container img {
      height: 80px; /* Tama√±o del logo */
      width: auto;
    }
    header h1 {
      font-size: 3em;
      margin: 0;
      font-weight: 700;
      line-height: 1;
    }
    header p {
      font-size: 1.3em;
      margin-top: 5px;
      font-weight: 300;
    }

    /* Navigation */
    nav {
      background: var(--secondary-color);
      display: flex;
      justify-content: center;
      padding: 15px 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      flex-wrap: wrap; /* Allow navigation items to wrap on smaller screens */
    }
    nav a, nav button {
      color: var(--bg-white);
      margin: 0 20px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1em;
      padding: 5px 0;
      transition: color 0.3s ease, border-bottom 0.3s ease;
      border-bottom: 2px solid transparent;
      background: none;
      border: none;
      cursor: pointer;
    }
    nav a:hover, nav button:hover {
      color: var(--accent-color);
      border-bottom: 2px solid var(--accent-color);
    }
    nav a.disabled {
      color: rgba(255, 255, 255, 0.5);
      cursor: not-allowed;
      border-bottom: 2px solid transparent;
    }

    /* Hero Section */
    .hero {
      padding: 80px 20px;
      text-align: center;
      background: linear-gradient(to bottom right, #e0f7fa, #f0f8ff);
      color: var(--text-dark);
    }
    .hero h1 {
      font-size: 3.2em;
      margin-bottom: 20px;
      font-weight: 700;
      color: var(--primary-color);
      line-height: 1.2;
    }
    .hero p {
      font-size: 1.4em;
      color: var(--text-light);
      max-width: 700px;
      margin: 0 auto;
      font-weight: 400;
    }

    /* Sections */
    .section {
      padding: 60px 20px;
      max-width: 1100px;
      margin: 0 auto;
    }
    .section h2, .section h3 {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 30px;
      font-size: 2.5em;
      font-weight: 700;
      position: relative;
    }
    .section h2::after, .section h3::after {
        content: '';
        display: block;
        width: 80px;
        height: 4px;
        background: var(--secondary-color);
        margin: 15px auto 0;
        border-radius: 2px;
    }
    .section p {
        font-size: 1.1em;
        margin-bottom: 1.5em;
        color: var(--text-light);
    }
    .section ul {
        list-style: none;
        padding-left: 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }
    .section ul li {
        background: var(--bg-white);
        padding: 15px 25px;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 15px var(--shadow-light);
        font-size: 1.15em;
        color: var(--text-dark);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: transform 0.3s ease;
    }
    .section ul li:hover {
        transform: translateY(-5px);
    }
    .section ul li img { /* For icons in lists */
        height: 30px;
        width: 30px;
    }
    .section img { /* General images within sections */
      display: block;
      margin: 0 auto 30px;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px var(--shadow-light);
    }

    /* Cards */
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin-top: 30px;
    }
    .card {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      box-shadow: 0 6px 20px var(--shadow-light);
      padding: 30px;
      width: 300px;
      text-align: center;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }
    .card img {
      width: 80px; /* Bigger icons for cards */
      height: 80px;
      margin-bottom: 20px;
      transition: transform 0.3s ease;
    }
    .card:hover img {
        transform: scale(1.1);
    }
    .card h3 {
      font-size: 1.8em;
      color: var(--primary-color);
      margin-bottom: 15px;
      font-weight: 700;
    }
    .card p {
      font-size: 1em;
      color: var(--text-light);
      line-height: 1.6;
    }
    .clickable-card {
      cursor: pointer;
    }
    .card-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(63, 104, 162, 0.95); /* Usar --primary-color con opacidad */
      color: var(--bg-white);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      font-weight: 600;
      font-size: 1.5em;
      border-radius: var(--border-radius);
    }
    .clickable-card:hover .card-overlay {
      opacity: 1;
    }

    /* Subject Pages */
    .subject-page {
      display: none;
      padding: 40px 20px;
    }
    .subject-page.active {
      display: block;
    }
    .back-button {
      background: var(--secondary-color);
      color: var(--bg-white);
      border: none;
      padding: 12px 25px;
      border-radius: var(--border-radius);
      cursor: pointer;
      margin-bottom: 30px;
      font-size: 1.1em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      display: inline-block; /* Para que margin-bottom funcione mejor */
    }
    .back-button:hover {
      background: var(--primary-color);
      transform: translateY(-2px);
    }
    .subject-page h1 {
      text-align: center;
      color: var(--primary-color);
      font-size: 3em;
      margin-bottom: 40px;
      font-weight: 700;
    }
    .subject-page .topic-list {
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 4px 15px var(--shadow-light);
    }
    .subject-page .topic-list h2 {
      text-align: center;
      color: var(--text-dark);
      margin-bottom: 25px;
      font-size: 2em;
      font-weight: 600;
    }
    .topic-item {
      background: #fdfdfd; /* Blanco m√°s claro */
      margin: 15px 0;
      padding: 20px;
      border-radius: var(--border-radius);
      border-left: 5px solid var(--secondary-color);
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
    }
    .topic-item:hover {
      background: #eef5fb; /* Ligeramente azulado al hover */
      transform: translateX(8px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .topic-title {
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 8px;
      font-size: 1.25em;
      display: flex;
      align-items: center;
      justify-content: space-between; /* Para alinear el badge y el indicador de progreso */
    }
    .topic-description {
      color: var(--text-light);
      font-size: 0.95em;
    }
    .level-badge {
      display: inline-block;
      background: var(--accent-color);
      color: var(--bg-white);
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      margin-left: 15px;
      font-weight: 600;
    }
    .progress-indicator {
      font-size: 0.9em;
      font-weight: 600;
      color: green;
      margin-left: auto; /* Empuja el indicador a la derecha */
    }

    /* Contact Form */
    .contact-form {
      text-align: center;
      background: var(--bg-white);
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 4px 15px var(--shadow-light);
      max-width: 700px;
      margin: 0 auto;
    }
    .contact-form p {
      font-size: 1.1em;
      margin-bottom: 25px;
      color: var(--text-dark);
    }
    .contact-form input,
    .contact-form textarea {
      width: calc(100% - 40px); /* Ajuste para padding */
      padding: 15px 20px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1.1em;
      color: var(--text-dark);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .contact-form input:focus,
    .contact-form textarea:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(63, 104, 162, 0.2);
      outline: none;
    }
    .contact-form button {
      background: var(--primary-color);
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.2em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      margin-top: 20px;
    }
    .contact-form button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
    }

    /* Footer */
    footer {
      background: var(--primary-color);
      color: white;
      text-align: center;
      padding: 25px;
      margin-top: 50px;
      font-size: 0.95em;
    }

    /* Quiz Styles */
    #quiz-container {
      background: var(--bg-white);
      max-width: 550px;
      margin: 60px auto;
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 8px 25px var(--shadow-light);
      display: none; /* Initially hidden */
    }
    #quiz-container h2 {
      color: var(--primary-color);
      margin-bottom: 30px;
      text-align: center;
      font-size: 2.2em;
      font-weight: 700;
    }
    .question {
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 1.3em;
      color: var(--text-dark);
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .options button {
      width: 100%;
      padding: 15px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.1em;
      transition: background 0.3s ease, transform 0.2s ease;
      text-align: left;
    }
    .options button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
    }
    /* Updated hidden utility class */
    .hidden {
      display: none !important; /* Added !important to ensure override */
    }
    /* Result Styles */
    #result-message {
      font-weight: 700;
      text-align: center;
      margin-bottom: 1.5rem;
      color: var(--primary-color);
      font-size: 1.5em;
      background: #eef5fb;
      padding: 15px;
      border-radius: var(--border-radius);
      border-left: 5px solid var(--secondary-color);
    }
    /* ADHD Recommendations */
    #tdah-warning {
      margin-top: 2.5rem;
      padding: 1.5rem;
      background-color: #ffe0b2; /* Tono naranja suave */
      border-radius: var(--border-radius);
      color: #b35900;
      font-weight: 600;
      max-width: 750px;
      margin-left: auto;
      margin-right: auto;
      border-left: 5px solid var(--accent-color);
      font-size: 1.1em;
    }
    #study-advice {
      max-width: 750px;
      margin: 0 auto 2rem auto;
      font-weight: 600;
      color: var(--text-dark);
      padding: 1.5rem;
      background: var(--bg-white);
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      border-left: 5px solid var(--primary-color);
      font-size: 1.1em;
    }

    /* Progress Bar Styles */
    .progress-bar-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: var(--border-radius);
      overflow: hidden;
      margin-bottom: 25px;
      height: 30px;
      position: relative;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    .progress-bar-fill {
      height: 100%;
      background-color: var(--secondary-color); /* Green color for progress */
      width: 0%; /* Will be updated by JS */
      border-radius: var(--border-radius) 0 0 var(--border-radius);
      transition: width 0.5s ease-in-out;
    }
    .progress-text {
      position: absolute;
      width: 100%;
      text-align: center;
      line-height: 30px;
      color: var(--text-dark);
      font-weight: 600;
      font-size: 1em;
    }

    /* Lesson Content Display */
    #lesson-content-display {
        background: var(--bg-white);
        max-width: 900px;
        margin: 60px auto;
        padding: 40px;
        border-radius: var(--border-radius);
        box-shadow: 0 8px 25px var(--shadow-light);
        min-height: 500px; /* Para que no se vea vac√≠o */
        display: none; /* Initially hidden */
    }
    #lesson-content-display.active {
        display: block;
    }
    #lesson-content-display h2 {
        text-align: center;
        color: var(--primary-color);
        margin-bottom: 30px;
        font-size: 2.2em;
        font-weight: 700;
    }
    #lesson-material p {
        font-size: 1.1em;
        margin-bottom: 1.5em;
        color: var(--text-light);
    }
    #lesson-material video,
    #lesson-material audio,
    #lesson-material img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 25px auto;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    #lesson-material textarea {
        width: calc(100% - 40px);
        padding: 15px 20px;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        font-family: 'Poppins', sans-serif;
        font-size: 1em;
        min-height: 120px;
        margin-top: 15px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }
    #lesson-material .interactive-game-placeholder {
        background-color: #eef5fb; /* Tono azul claro */
        border: 2px dashed var(--secondary-color);
        padding: 60px;
        text-align: center;
        font-style: italic;
        color: var(--text-light);
        border-radius: var(--border-radius);
        margin: 30px 0;
        font-size: 1.2em;
    }
    #lesson-material button {
        background: var(--accent-color);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 1.1em;
        font-weight: 600;
        transition: background 0.3s ease, transform 0.2s ease;
        margin-top: 20px;
    }
    #lesson-material button:hover {
        background: #e67e22; /* Tono m√°s oscuro de naranja */
        transform: translateY(-2px);
    }

    /* Custom Message Box */
    #custom-message {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--primary-color);
        color: white;
        padding: 15px 30px;
        border-radius: var(--border-radius);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: none; /* Hidden by default */
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        font-weight: 600;
    }
    #custom-message.show {
        opacity: 1;
        display: block;
    }

    /* Modal Overlay */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      display: none; /* Hidden by default */
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .modal-overlay.active {
        display: flex;
    }

    /* Authentication Form Styles (within modal) */
    #auth-container {
      background: var(--bg-white);
      max-width: 450px;
      padding: 40px;
      border-radius: var(--border-radius);
      box-shadow: 0 8px 25px var(--shadow-light);
      text-align: center;
      position: relative; /* Needed for close button positioning */
    }
    #auth-container h2 {
      color: var(--primary-color);
      margin-bottom: 30px;
      font-size: 2.2em;
      font-weight: 700;
    }
    #auth-container form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    #auth-container input[type="email"],
    #auth-container input[type="password"] {
      width: calc(100% - 40px);
      padding: 15px 20px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1.1em;
      color: var(--text-dark);
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    #auth-container input[type="email"]:focus,
    #auth-container input[type="password"]:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(63, 104, 162, 0.2);
      outline: none;
    }
    #auth-container button {
      background: var(--primary-color);
      color: white;
      padding: 15px 20px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1.2em;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      margin-top: 10px;
    }
    #auth-container button:hover {
      background: var(--secondary-color);
      transform: translateY(-2px);
    }
    #auth-container .toggle-form-link {
        font-size: 0.95em;
        margin-top: 20px;
        color: var(--text-light);
        cursor: pointer;
        text-decoration: underline;
    }
    #auth-container .toggle-form-link:hover {
        color: var(--primary-color);
    }
    .close-modal-button {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 1.8em;
        color: var(--text-light);
        cursor: pointer;
        transition: color 0.3s ease;
    }
    .close-modal-button:hover {
        color: var(--primary-color);
    }


    /* Responsive adjustments */
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2em;
      }
      header .logo-container img {
        height: 60px;
      }
      .hero h1 {
        font-size: 2.5em;
      }
      .hero p {
        font-size: 1em;
      }
      nav {
        flex-direction: column;
        align-items: center;
        padding: 10px;
      }
      nav a, nav button {
        margin: 5px 0;
        font-size: 1em;
      }
      .section h2, .section h3 {
        font-size: 2em;
      }
      .cards, .testimonials-grid {
        flex-direction: column;
        align-items: center;
      }
      .card, .testimonial-card {
        width: 90%;
        max-width: 350px;
      }
      .contact-form input,
      .contact-form textarea {
        width: calc(100% - 20px);
        padding: 12px 10px;
      }
      #quiz-container, #lesson-content-display, #auth-container {
        margin: 30px auto;
        padding: 25px;
      }
      .question {
        font-size: 1.1em;
      }
    }
  </style>
</head>
<body>

  <!-- Custom Message Box -->
  <div id="custom-message" class="hidden"></div>

  <!-- Authentication Modal -->
  <div id="auth-modal-overlay" class="modal-overlay">
    <div id="auth-container">
      <button class="close-modal-button" onclick="hideAuthModal()">&times;</button>
      <div id="login-form">
        <h2>Iniciar Sesi√≥n</h2>
        <form id="login-email-form">
          <input type="email" id="login-email" placeholder="Correo Electr√≥nico" required />
          <input type="password" id="login-password" placeholder="Contrase√±a" required />
          <button type="submit">Iniciar Sesi√≥n</button>
        </form>
        <p class="toggle-form-link" onclick="toggleAuthForm('register')">¬øNo tienes cuenta? Reg√≠strate</p>
      </div>

      <div id="register-form" class="hidden">
        <h2>Registrarse</h2>
        <form id="register-email-form">
          <input type="email" id="register-email" placeholder="Correo Electr√≥nico" required />
          <input type="password" id="register-password" placeholder="Contrase√±a" required />
          <button type="submit">Registrarse</button>
        </form>
        <p class="toggle-form-link" onclick="toggleAuthForm('login')">¬øYa tienes cuenta? Inicia Sesi√≥n</p>
      </div>
    </div>
  </div>


  <div id="quiz-container" class="hidden">
    <h2>Cuestionario de Estilo de Aprendizaje</h2>
    <div id="question-text" class="question"></div>
    <div id="options" class="options"></div>
  </div>

  <div id="main-content">
    <header>
      <div class="logo-container">
        <img src="https://placehold.co/80x80/6ed3b3/ffffff?text=LOGO" alt="MultiGenio Logo" />
        <h1>MultiGenio</h1>
      </div>
      <p>Tu aliado en el aprendizaje</p>
    </header>

    <nav>
      <a href="#que-es">¬øQu√© es?</a>
      <a href="#materias">Materias</a>
      <a href="#beneficios">Beneficios</a>
      <a href="#testimonios">Testimonios</a>
      <a href="#contacto">Contacto</a>
      <a href="#" id="auth-nav-link" onclick="showAuthModal()">Iniciar Sesi√≥n / Registrarse</a>
      <a href="#" id="quiz-nav-link" class="hidden" onclick="showQuestion()">Cuestionario</a>
      <button id="logout-button" class="hidden">Cerrar Sesi√≥n</button>
    </nav>

    <section class="hero">
      <h1>Tu tutor virtual inteligente para Matem√°ticas, Ingl√©s y Lengua</h1>
      <p>Un m√©todo de aprendizaje din√°mico, adaptado a tu ritmo y estilo, dise√±ado para potenciar tu concentraci√≥n y comprensi√≥n.</p>
    </section>

    <div id="result-message"></div>
    <div id="study-advice"></div>
    <div id="tdah-warning" class="hidden">
      ‚ö†Ô∏è Si presentas indicios de TDAH, MultiGenio te ofrecer√° recursos y estrategias especiales para ayudarte a mantener la concentraci√≥n y aprovechar tu estilo de aprendizaje de la forma m√°s efectiva.
    </div>

    <section class="section" id="que-es">
      <h2>¬øQu√© es MultiGenio?</h2>
      <img src="https://img.icons8.com/color/96/online-support.png" alt="Estudio interactivo" style="width: 100px; height: 100px;"/>
      <p>
        <strong>MultiGenio</strong> es una plataforma educativa innovadora que revoluciona el aprendizaje, especialmente dise√±ada para estudiantes con **TDAH**, dificultades de atenci√≥n o aquellos que buscan un m√©todo de estudio verdaderamente personalizado. A trav√©s de la integraci√≥n de **Inteligencia Artificial Avanzada**, MultiGenio no solo se adapta al ritmo del alumno, sino que moldea activamente la experiencia educativa para maximizar la absorci√≥n del conocimiento y el mantenimiento del inter√©s.
      </p>

      <h3>üß† La Inteligencia Artificial en Acci√≥n: Un Enfoque Adaptativo</h3>
      <img src="https://img.icons8.com/color/96/artificial-intelligence.png" alt="Inteligencia Artificial" style="width: 100px; height: 100px;"/>
      <p>
        Nuestra IA propietaria va m√°s all√° de un simple algoritmo. Analiza patrones de respuesta en el cuestionario inicial, el progreso en los juegos interactivos, el tiempo dedicado a cada tema y las preferencias de material (visual, auditivo, etc.). Con estos datos, el sistema ajusta din√°micamente la dificultad de los ejercicios, prioriza ciertos tipos de contenido y sugiere rutas de aprendizaje alternativas. Por ejemplo, si un estudiante visual tiene dificultades con un concepto, la IA podr√≠a recomendar un video explicativo animado o un mapa mental interactivo antes de ofrecer otro tipo de ejercicio. Para alumnos con TDAH, la IA puede fragmentar lecciones extensas en m√≥dulos m√°s cortos, incorporar micro-descansos activos o activar alertas visuales/auditivas sutiles para refocus.
      </p>
      <p>
        El objetivo es crear un "tutor virtual" que comprende las fortalezas y desaf√≠os individuales, proporcionando una experiencia educativa que se siente hecha a la medida, minimizando las distracciones y potenciando la concentraci√≥n.
      </p>

      <h2>ÔøΩ Cuestionario Inicial: Tu Huella de Aprendizaje</h2>
      <img src="https://img.icons8.com/color/96/quiz.png" alt="Cuestionario" style="width: 100px; height: 100px;"/>
      <p>
        Antes de sumergirte en el aprendizaje, MultiGenio te invita a un **cuestionario interactivo y estrat√©gico de 5 preguntas**. Este no es un simple test; es una herramienta clave para nuestra IA. Las preguntas est√°n cuidadosamente dise√±adas para identificar tu estilo de aprendizaje predominante entre:
      </p>
      <ul>
        <li><img src="https://img.icons8.com/color/48/eye.png" alt="Visual icon"/> <strong>Visual:</strong> Aprendes mejor viendo im√°genes, gr√°ficos, diagramas y videos.</li>
        <li><img src="https://img.icons8.com/color/48/ear.png" alt="Auditivo icon"/> <strong>Auditivo:</strong> Retienes informaci√≥n escuchando explicaciones, debates o audios.</li>
        <li><img src="https://img.icons8.com/color/48/writing.png" alt="Lectura/Escritura icon"/> <strong>Lectura/Escritura:</strong> Tu fuerza est√° en leer textos, tomar notas y escribir res√∫menes.</li>
        <li><img src="https://img.icons8.com/color/48/running.png" alt="Kinest√©sico icon"/> <strong>Kinest√©sico:</strong> Necesitas "hacer" para aprender; prefieres actividades pr√°cticas y movimiento.</li>
      </ul>
      <p>
        Adem√°s, una de las preguntas est√° formulada para detectar indicios que podr√≠an ser compatibles con TDAH. Si se identifican estas se√±ales, la plataforma activar√° un conjunto de estrategias pedag√≥gicas y recursos especiales, como temporizadores de foco, desaf√≠os de atenci√≥n y formatos de contenido adaptados, para asegurar una experiencia de aprendizaje √≥ptima y libre de frustraciones. Este perfil inicial es la base sobre la cual la IA personaliza cada aspecto de tu trayectoria en MultiGenio.
      </p>
    </section>
   
    <section class="section" id="materias">
      <h2>Materias que puedes aprender</h2>
      <div class="cards">
        <div class="card clickable-card" onclick="showSubject('matematicas')">
          <img src="https://img.icons8.com/color/96/calculator.png" alt="Matem√°ticas" />
          <h3>Matem√°ticas</h3>
          <p>Desde sumas y divisiones hasta √°lgebra de 3¬∫ de ESO. Todo con juegos mentales, visuales y l√≥gica adaptada a ti.</p>
          <div class="card-overlay">
            <span>¬°Haz clic para empezar!</span>
          </div>
        </div>
        <div class="card clickable-card" onclick="showSubject('lengua')">
          <img src="https://img.icons8.com/color/96/book.png" alt="Lengua" />
          <h3>Lengua</h3>
          <p>Domina la morfolog√≠a, sintaxis y reglas ortogr√°ficas con ejemplos creativos y pr√°cticas f√°ciles de recordar.</p>
          <div class="card-overlay">
            <span>¬°Haz clic para empezar!</span>
          </div>
        </div>
        <div class="card clickable-card" onclick="showSubject('ingles')">
          <img src="https://img.icons8.com/color/96/usa.png" alt="Ingl√©s" />
          <h3>Ingl√©s</h3>
          <p>Aprende desde A1 hasta B1: vocabulario, gram√°tica, listening y speaking. Con apoyo visual y audios.</p>
          <div class="card-overlay">
            <span>¬°Haz clic para empezar!</span>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="beneficios">
      <h2>¬øPor qu√© elegir MultiGenio?</h2>
      <ul>
        <li><img src="https://img.icons8.com/color/48/star--v1.png" alt="Star icon"/> Explicaciones adaptadas a estudiantes con TDA/TDAH</li>
        <li><img src="https://img.icons8.com/color/48/video-camera.png" alt="Video icon"/> Videos, ejemplos y contenido creativo</li>
        <li><img src="https://img.icons8.com/color/48/brain.png" alt="Brain icon"/> Aprende a tu propio ritmo, sin presi√≥n</li>
        <li><img src="https://img.icons8.com/color/48/graduation-cap.png" alt="Graduation cap icon"/> Ideal para padres, docentes y alumnos</li>
      </ul>
    </section>

    <section class="section" id="testimonios">
      <h2>Lo que dicen nuestros alumnos</h2>
      <div class="cards testimonials-grid">
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/student-male.png" alt="Estudiante 1" />
          <h3>Laura G.</h3>
          <p>"¬°MultiGenio cambi√≥ mi forma de ver las matem√°ticas! Siempre me frustraba, pero con sus explicaciones visuales y los juegos interactivos, ahora entiendo todo mucho mejor. ¬°Recomendad√≠simo!"</p>
          <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/student-female.png" alt="Estudiante 2" />
          <h3>Pablo R.</h3>
          <p>"Como padre de un ni√±o con TDAH, encontrar MultiGenio ha sido una bendici√≥n. La paciencia y el enfoque adaptado de la plataforma son incre√≠bles. Mi hijo est√° motivado y aprendiendo sin estr√©s."</p>
          <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
        <div class="card testimonial-card">
          <img src="https://img.icons8.com/color/96/teacher.png" alt="Estudiante 3" />
          <h3>Sof√≠a M. (Profesora)</h3>
          <p>"He probado muchas herramientas, pero MultiGenio es √∫nica por su capacidad de adaptaci√≥n. La IA es una maravilla para detectar y apoyar a cada alumno seg√∫n su estilo. La recomiendo a todos mis colegas."</p>
          <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
        </div>
      </div>
    </section>

    <section class="section" id="contacto">
      <h2>Contacto</h2>
      <div class="contact-form">
        <p>¬øQuieres probar MultiGenio o tienes dudas? Env√≠anos un mensaje:</p>
        <form>
          <input type="text" placeholder="Tu nombre" required /><br />
          <input type="email" placeholder="Tu correo electr√≥nico" required /><br />
          <textarea placeholder="Tu mensaje..." rows="5" required></textarea><br />
          <button type="submit">Enviar mensaje</button>
        </form>
      </div>
    </section>

    <script>
      window.chatbaseConfig = {
        chatbotId: "frw3UKvg6MK3c9Zw-bZAu"
      };
    </script>
    <script src="https://www.chatbase.co/embed.min.js" defer></script>

    <footer>
      <p>&copy; 2025 MultiGenio. Todos los derechos reservados.</p>
    </footer>
  </div>

  <div id="matematicas-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">‚Üê Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">üìä Matem√°ticas</h1>
      <div id="math-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="matematicas-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="matematicas-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'operaciones-basicas')">
          <div class="topic-title">Operaciones B√°sicas <span class="level-badge">Primaria</span>
            <span class="progress-indicator" id="progress-matematicas-operaciones-basicas"></span>
          </div>
          <div class="topic-description">Suma, resta, multiplicaci√≥n y divisi√≥n. Problemas pr√°cticos del d√≠a a d√≠a.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'fracciones')">
          <div class="topic-title">Fracciones y Decimales <span class="level-badge">6¬∫ Primaria</span>
            <span class="progress-indicator" id="progress-matematicas-fracciones"></span>
          </div>
          <div class="topic-description">Conceptos, operaciones y equivalencias. Con ejemplos visuales.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'porcentajes')">
          <div class="topic-title">Porcentajes <span class="level-badge">1¬∫ ESO</span>
            <span class="progress-indicator" id="progress-matematicas-porcentajes"></span>
          </div>
          <div class="topic-description">C√°lculo de porcentajes, aumentos y descuentos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'ecuaciones')">
          <div class="topic-title">Ecuaciones de Primer Grado <span class="level-badge">2¬∫ ESO</span>
            <span class="progress-indicator" id="progress-matematicas-ecuaciones"></span>
          </div>
          <div class="topic-description">Resoluci√≥n paso a paso con m√©todos visuales.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'sistemas')">
          <div class="topic-title">Sistemas de Ecuaciones <span class="level-badge">3¬∫ ESO</span>
            <span class="progress-indicator" id="progress-matematicas-sistemas"></span>
          </div>
          <div class="topic-description">M√©todos de sustituci√≥n, igualaci√≥n y reducci√≥n.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('matematicas', 'geometria')">
          <div class="topic-title">Geometr√≠a B√°sica <span class="level-badge">1¬∫-2¬∫ ESO</span>
            <span class="progress-indicator" id="progress-matematicas-geometria"></span>
          </div>
          <div class="topic-description">√Åreas, per√≠metros y vol√∫menes de figuras b√°sicas.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="lengua-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">‚Üê Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">üìö Lengua Espa√±ola</h1>
      <div id="lengua-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="lengua-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="lengua-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'ortografia-basica')">
          <div class="topic-title">Ortograf√≠a B√°sica <span class="level-badge">Primaria</span>
            <span class="progress-indicator" id="progress-lengua-ortografia-basica"></span>
          </div>
          <div class="topic-description">Acentuaci√≥n, uso de b/v, g/j, h. Con ejercicios pr√°cticos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'morfologia')">
          <div class="topic-title">Morfolog√≠a <span class="level-badge">1¬∫ ESO</span>
            <span class="progress-indicator" id="progress-lengua-morfologia"></span>
          </div>
          <div class="topic-description">Categor√≠as gramaticales: sustantivos, adjetivos, verbos, etc.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'sintaxis-simple')">
          <div class="topic-title">Sintaxis - Oraci√≥n Simple <span class="level-badge">2¬∫ ESO</span>
            <span class="progress-indicator" id="progress-lengua-sintaxis-simple"></span>
          </div>
          <div class="topic-description">Sujeto, predicado y complementos b√°sicos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'sintaxis-compuesta')">
          <div class="topic-title">Sintaxis - Oraci√≥n Compuesta <span class="level-badge">3¬∫ ESO</span>
            <span class="progress-indicator" id="progress-lengua-sintaxis-compuesta"></span>
          </div>
          <div class="topic-description">Oraciones coordinadas y subordinadas.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'literatura')">
          <div class="topic-title">Literatura Espa√±ola <span class="level-badge">2¬∫-3¬∫ ESO</span>
            <span class="progress-indicator" id="progress-lengua-literatura"></span>
          </div>
          <div class="topic-description">G√©neros literarios, m√©trica y autores principales.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('lengua', 'expresion-escrita')">
          <div class="topic-title">Expresi√≥n Escrita <span class="level-badge">Todos</span>
            <span class="progress-indicator" id="progress-lengua-expresion-escrita"></span>
          </div>
          <div class="topic-description">T√©cnicas de redacci√≥n, tipos de texto y coherencia.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="ingles-page" class="subject-page">
    <div class="section">
      <button class="back-button" onclick="showMainContent()">‚Üê Volver al inicio</button>
      <h1 style="text-align: center; color: var(--primary-color);">üá¨üáß English</h1>
      <div id="ingles-personalized-intro"></div>

      <div class="progress-bar-container">
        <div class="progress-bar-fill" id="ingles-progress-fill" style="width: 0%;"></div>
        <span class="progress-text" id="ingles-progress-text">0% completado</span>
      </div>
      
      <div class="topic-list">
        <h2>Temario por niveles</h2>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'basic-vocabulary')">
          <div class="topic-title">Basic Vocabulary <span class="level-badge">A1</span>
            <span class="progress-indicator" id="progress-ingles-basic-vocabulary"></span>
          </div>
          <div class="topic-description">Numbers, colors, family, daily routines. Con apoyo visual.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'present-tenses')">
          <div class="topic-title">Present Simple & Continuous <span class="level-badge">A1-A2</span>
            <span class="progress-indicator" id="progress-ingles-present-tenses"></span>
          </div>
          <div class="topic-description">Tiempos verbales b√°sicos con ejemplos pr√°cticos.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'past-tenses')">
          <div class="topic-title">Past Simple & Past Continuous <span class="level-badge">A2</span>
            <span class="progress-indicator" id="progress-ingles-past-tenses"></span>
          </div>
          <div class="topic-description">Narraci√≥n en pasado, verbos regulares e irregulares.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'future-tenses')">
          <div class="topic-title">Future Tenses <span class="level-badge">A2-B1</span>
            <span class="progress-indicator" id="progress-ingles-future-tenses"></span>
          </div>
          <div class="topic-description">Will, going to, present continuous for future.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'conditionals')">
          <div class="topic-title">Conditionals <span class="level-badge">B1</span>
            <span class="progress-indicator" id="progress-ingles-conditionals"></span>
          </div>
          <div class="topic-description">First, second and third conditional sentences.</div>
        </div>
        
        <div class="topic-item" onclick="showLessonContent('ingles', 'listening-speaking')">
          <div class="topic-title">Listening & Speaking <span class="level-badge">A1-B1</span>
            <span class="progress-indicator" id="progress-ingles-listening-speaking"></span>
          </div>
          <div class="topic-description">Ejercicios de comprensi√≥n auditiva y pronunciaci√≥n.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="lesson-content-display" class="hidden">
    <button class="back-button" onclick="hideLessonContent()">‚Üê Volver al temario</button>
    <h2 id="lesson-title"></h2>
    <div id="lesson-material"></div>
  </div>


  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-analytics.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDklyhhZOV3c2KbbrvAZOpoUitPBWgRBOQ",
      authDomain: "multigenio-39890.firebaseapp.com",
      projectId: "multigenio-39890",
      storageBucket: "multigenio-39890.firebasestorage.app",
      messagingSenderId: "881137429405",
      appId: "1:881137429405:web:9f061138bdf43b00dd5d74",
      measurementId: "G-9SQX18GVH6"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app); // Initialize Firebase Auth service

    // DOM elements
    const authModalOverlay = document.getElementById('auth-modal-overlay');
    const authContainer = document.getElementById('auth-container'); // This is now inside the modal overlay
    const loginFormDiv = document.getElementById('login-form');
    const registerFormDiv = document.getElementById('register-form');
    const loginEmailInput = document.getElementById('login-email');
    const loginPasswordInput = document.getElementById('login-password');
    const registerEmailInput = document.getElementById('register-email');
    const registerPasswordInput = document.getElementById('register-password');
    const logoutButton = document.getElementById('logout-button');
    const quizNavLink = document.getElementById('quiz-nav-link');
    const authNavLink = document.getElementById('auth-nav-link'); // New auth nav link

    const quizContainer = document.getElementById('quiz-container');
    const mainContent = document.getElementById('main-content');
    const questionText = document.getElementById('question-text');
    const optionsDiv = document.getElementById('options');
    const resultMessage = document.getElementById('result-message');
    const tdahWarning = document.getElementById('tdah-warning');
    const studyAdvice = document.getElementById('study-advice');
    const lessonContentDisplay = document.getElementById('lesson-content-display');
    const customMessage = document.getElementById('custom-message');

    let isAuthenticated = false; // Flag to track authentication status

    // Function to show custom messages instead of alerts
    function showMessage(message, duration = 3000) {
        customMessage.textContent = message;
        customMessage.classList.add('show');
        setTimeout(() => {
            customMessage.classList.remove('show');
        }, duration);
    }

    // Function to toggle between login and register forms
    window.toggleAuthForm = function(formToShow) {
      if (formToShow === 'login') {
        loginFormDiv.classList.remove('hidden');
        registerFormDiv.classList.add('hidden');
      } else {
        loginFormDiv.classList.add('hidden');
        registerFormDiv.classList.remove('hidden');
      }
    }

    // Function to show the authentication modal
    window.showAuthModal = function() {
        authModalOverlay.classList.add('active');
        // Hide all other content when modal is active
        mainContent.classList.add('hidden');
        quizContainer.classList.add('hidden');
        lessonContentDisplay.classList.add('hidden');
        document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden'));
        toggleAuthForm('login'); // Always show login form when modal opens
    }

    // Function to hide the authentication modal
    window.hideAuthModal = function() {
        authModalOverlay.classList.remove('active');
        // Restore main content visibility if authenticated
        if (isAuthenticated) {
            mainContent.classList.remove('hidden');
        }
    }

    // Register user with email and password
    document.getElementById('register-email-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = registerEmailInput.value;
      const password = registerPasswordInput.value;

      try {
        await createUserWithEmailAndPassword(auth, email, password);
        showMessage('¬°Registro exitoso! Has iniciado sesi√≥n.');
        // onAuthStateChanged will handle UI update
      } catch (error) {
        let errorMessage = 'Error al registrar: ';
        switch (error.code) {
            case 'auth/email-already-in-use':
                errorMessage += 'El correo electr√≥nico ya est√° en uso.';
                break;
            case 'auth/invalid-email':
                errorMessage += 'El formato del correo electr√≥nico no es v√°lido.';
                break;
            case 'auth/weak-password':
                errorMessage += 'La contrase√±a debe tener al menos 6 caracteres.';
                break;
            default:
                errorMessage += error.message;
        }
        showMessage(errorMessage, 5000);
        console.error("Error al registrar:", error);
      }
    });

    // Sign in user with email and password
    document.getElementById('login-email-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = loginEmailInput.value;
      const password = loginPasswordInput.value;

      try {
        await signInWithEmailAndPassword(auth, email, password);
        showMessage('¬°Inicio de sesi√≥n exitoso!');
        // onAuthStateChanged will handle UI update
      } catch (error) {
        let errorMessage = 'Error al iniciar sesi√≥n: ';
        switch (error.code) {
            case 'auth/invalid-credential':
                errorMessage += 'Credenciales inv√°lidas. Por favor, verifica tu correo y contrase√±a.';
                break;
            case 'auth/user-not-found': // Firebase sometimes uses this for invalid credentials too
            case 'auth/wrong-password':
                errorMessage += 'Correo o contrase√±a incorrectos.';
                break;
            case 'auth/invalid-email':
                errorMessage += 'El formato del correo electr√≥nico no es v√°lido.';
                break;
            default:
                errorMessage += error.message;
        }
        showMessage(errorMessage, 5000);
        console.error("Error al iniciar sesi√≥n:", error);
      }
    });

    // Logout button event listener
    logoutButton.addEventListener('click', async () => {
      try {
        await signOut(auth);
        showMessage('Has cerrado sesi√≥n.');
        // onAuthStateChanged will handle UI update
      } catch (error) {
        showMessage('Error al cerrar sesi√≥n: ' + error.message, 5000);
        console.error("Error al cerrar sesi√≥n:", error);
      }
    });

    // Listen for authentication state changes
    onAuthStateChanged(auth, (user) => {
      if (user) {
        isAuthenticated = true;
        hideAuthModal(); // Hide modal if user logs in
        mainContent.classList.remove('hidden');
        quizNavLink.classList.remove('hidden');
        logoutButton.classList.remove('hidden');
        authNavLink.classList.add('hidden'); // Hide login/register link
        showMessage('Bienvenido de nuevo.');
        showMainContent(); // Ensure main content is visible after login
      } else {
        isAuthenticated = false;
        // Do NOT show the modal immediately on logout, let the user click the link
        mainContent.classList.remove('hidden'); // Main content is visible initially even if logged out
        quizContainer.classList.add('hidden');
        lessonContentDisplay.classList.add('hidden');
        document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden'));

        quizNavLink.classList.add('hidden');
        logoutButton.classList.add('hidden');
        authNavLink.classList.remove('hidden'); // Show login/register link
        showMessage('Inicia sesi√≥n o reg√≠strate para acceder a todas las funciones.', 5000);
      }
    });


    // Preguntas del cuestionario
    const quizQuestions = [
      {
        question: "¬øC√≥mo prefieres aprender?",
        options: [
          { text: "Viendo im√°genes, gr√°ficos o videos", value: "visual" },
          { text: "Escuchando explicaciones o audios", value: "auditivo" },
          { text: "Leyendo o escribiendo textos", value: "lectura-escritura" },
          { text: "Haciendo actividades pr√°cticas o manipulativas", value: "kinestesico" }
        ]
      },
      {
        question: "¬øSueles tener dificultades para mantener la atenci√≥n o concentraci√≥n?",
        options: [
          { text: "S√≠, frecuentemente", value: "tdah" },
          { text: "A veces", value: "a-veces" },
          { text: "No, casi nunca", value: "no" }
        ]
      },
      {
        question: "Cuando estudias, ¬øqu√© te ayuda m√°s a entender y recordar?",
        options: [
          { text: "Ver esquemas o mapas conceptuales", value: "visual" },
          { text: "Escuchar grabaciones o explicaciones en voz alta", value: "auditivo" },
          { text: "Tomar notas o leer textos varias veces", value: "lectura-escritura" },
          { text: "Hacer ejercicios pr√°cticos o moverme mientras estudio", value: "kinestesico" }
        ]
      },
      {
        question: "¬øQu√© actividad prefieres para aprender algo nuevo?",
        options: [
          { text: "Observar demostraciones visuales", value: "visual" },
          { text: "Participar en discusiones o escuchar explicaciones", value: "auditivo" },
          { text: "Leer libros o escribir res√∫menes", value: "lectura-escritura" },
          { text: "Experimentar y practicar directamente", value: "kinestesico" }
        ]
      },
      {
        question: "¬øC√≥mo recuerdas mejor la informaci√≥n?",
        options: [
          { text: "Recordando im√°genes y colores", value: "visual" },
          { text: "Recordando sonidos o palabras", value: "auditivo" },
          { text: "Recordando textos o frases escritas", value: "lectura-escritura" },
          { text: "Recordando sensaciones y movimientos", value: "kinestesico" }
        ]
      }
    ];

    let currentQuestionIndex = 0;
    let selectedAnswers = {};
    let userLearningStyle = 'visual'; // Variable global para almacenar el estilo

    // --- Data de Temas para C√°lculo de Progreso ---
    const mathTopics = [
      { id: 'operaciones-basicas', text: 'Operaciones B√°sicas' },
      { id: 'fracciones', text: 'Fracciones y Decimales' },
      { id: 'porcentajes', text: 'Porcentajes' },
      { id: 'ecuaciones', text: 'Ecuaciones de Primer Grado' },
      { id: 'sistemas', text: 'Sistemas de Ecuaciones' },
      { id: 'geometria', text: 'Geometr√≠a B√°sica' }
    ];

    const lenguaTopics = [
      { id: 'ortografia-basica', text: 'Ortograf√≠a B√°sica' },
      { id: 'morfologia', text: 'Morfolog√≠a' },
      { id: 'sintaxis-simple', text: 'Sintaxis - Oraci√≥n Simple' },
      { id: 'sintaxis-compuesta', text: 'Sintaxis - Oraci√≥n Compuesta' },
      { id: 'literatura', text: 'Literatura Espa√±ola' },
      { id: 'expresion-escrita', text: 'Expresi√≥n Escrita' }
    ];

    const inglesTopics = [
      { id: 'basic-vocabulary', text: 'Basic Vocabulary' },
      { id: 'present-tenses', text: 'Present Simple & Continuous' },
      { id: 'past-tenses', text: 'Past Simple & Past Continuous' },
      { id: 'future-tenses', text: 'Future Tenses' },
      { id: 'conditionals', text: 'Conditionals' },
      { id: 'listening-speaking', text: 'Listening & Speaking' }
    ];

    // --- Funciones de Cuestionario ---
    function showQuestion() {
      if (!isAuthenticated) {
        showMessage('Por favor, inicia sesi√≥n para acceder al cuestionario.');
        showAuthModal(); // Show auth modal if not authenticated
        return;
      }
      // Hide all other content
      hideAuthModal();
      mainContent.classList.add('hidden');
      document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden'));
      lessonContentDisplay.classList.add('hidden');

      // Show quiz container
      quizContainer.classList.remove('hidden');

      if (currentQuestionIndex >= quizQuestions.length) {
        finishQuiz();
        return;
      }

      const currentQ = quizQuestions[currentQuestionIndex];
      questionText.textContent = currentQ.question;
      optionsDiv.innerHTML = '';
      
      currentQ.options.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.textContent = option.text;
        btn.onclick = () => {
          selectedAnswers[currentQuestionIndex] = option.value;
          currentQuestionIndex++;
          showQuestion();
        };
        optionsDiv.appendChild(btn);
      });
    }

    function finishQuiz() {
      // Ocultar cuestionario
      quizContainer.classList.add('hidden');
      // Mostrar contenido principal
      mainContent.classList.remove('hidden');

      // Conteo de estilos, excepto la pregunta 1 (TDAH - √≠ndice 1)
      const styleCounts = {
        visual: 0,
        auditivo: 0,
        'lectura-escritura': 0,
        kinestesico: 0
      };

      for(let i = 0; i < quizQuestions.length; i++){
        if(i === 1) continue; // Saltar la pregunta de TDAH (√≠ndice 1)
        const ans = selectedAnswers[i];
        if(styleCounts.hasOwnProperty(ans)){
          styleCounts[ans]++;
        }
      }

      // Elegir el estilo con mayor puntuaci√≥n
      let maxStyle = 'visual';
      let maxCount = 0;
      for(const style in styleCounts){
        if(styleCounts[style] > maxCount){
          maxCount = styleCounts[style];
          maxStyle = style;
        }
      }

      // Mostrar recomendaciones seg√∫n estilo
      const adviceByStyle = {
        visual: "Recomendamos usar esquemas, mapas conceptuales, videos y colores para organizar tus ideas. Aprovecha im√°genes y gr√°ficos para estudiar.",
        auditivo: "Aprende mejor con grabaciones, podcasts, explicaciones en voz alta y repitiendo la informaci√≥n oralmente.",
        'lectura-escritura': "Prefiere leer textos, tomar apuntes, escribir res√∫menes y usar listas para organizar la informaci√≥n.",
        kinestesico: "Es ideal aprender haciendo, usando actividades pr√°cticas, movimientos o ejercicios mientras estudias."
      };

      // Mostrar mensaje resultado
      const styleNames = {
        visual: "Visual",
        auditivo: "Auditivo", 
        'lectura-escritura': "Lectura/Escritura",
        kinestesico: "Kinest√©sico"
      };

      resultMessage.textContent = `üéØ Tu estilo de aprendizaje detectado: ${styleNames[maxStyle]}`;
      studyAdvice.textContent = adviceByStyle[maxStyle] || "";
      
      // Guardar el estilo de aprendizaje globalmente
      userLearningStyle = maxStyle;

      // Mostrar advertencia TDAH si aplica
      const tdahAnswer = selectedAnswers[1]; // La pregunta TDAH est√° en el √≠ndice 1
      if(tdahAnswer === 'tdah'){
        tdahWarning.classList.remove('hidden');
      }

      // Cargar y actualizar el progreso al finalizar el cuestionario
      loadProgressAndDisplay();
      updateAllProgressBars();
    }

    // --- Funciones de Progreso (localStorage) ---
    function saveProgress(subject, topicId, status) {
      const progressKey = `progress_${subject}_${topicId}`;
      localStorage.setItem(progressKey, status);
      // Tras guardar, actualizamos los indicadores y las barras de progreso
      loadProgressAndDisplay();
      updateAllProgressBars();
    }

    function loadProgressAndDisplay() {
      // Actualizar indicadores individuales de tema
      [
        ...mathTopics.map(t => ({ subject: 'matematicas', topic: t })),
        ...lenguaTopics.map(t => ({ subject: 'lengua', topic: t })),
        ...inglesTopics.map(t => ({ subject: 'ingles', topic: t }))
      ].forEach(({ subject, topic }) => {
        const progressKey = `progress_${subject}_${topic.id}`;
        const status = localStorage.getItem(progressKey);
        const indicator = document.getElementById(`progress-${subject}-${topic.id}`);
        if (indicator) {
          if (status === 'completed') {
            indicator.innerHTML = '<span style="color: green; font-weight: bold; margin-left: 10px;">‚úÖ Completado</span>';
          } else {
            indicator.innerHTML = ''; // Limpiar si no est√° completado
          }
        }
      });
    }

    function updateSubjectProgress(subject, topicsArray, progressFillId, progressTextId) {
      let completedCount = 0;
      topicsArray.forEach(topic => {
        const progressKey = `progress_${subject}_${topic.id}`;
        if (localStorage.getItem(progressKey) === 'completed') {
          completedCount++;
        }
      });

      const totalTopics = topicsArray.length;
      const percentage = totalTopics > 0 ? (completedCount / totalTopics) * 100 : 0;

      const progressBarFill = document.getElementById(progressFillId);
      const progressBarText = document.getElementById(progressTextId);

      if (progressBarFill && progressBarText) {
        progressBarFill.style.width = `${percentage}%`;
        progressBarText.textContent = `${Math.round(percentage)}% completado`;
      }
    }

    function updateAllProgressBars() {
      updateSubjectProgress('matematicas', mathTopics, 'matematicas-progress-fill', 'matematicas-progress-text');
      updateSubjectProgress('lengua', lenguaTopics, 'lengua-progress-fill', 'lengua-progress-text');
      updateSubjectProgress('ingles', inglesTopics, 'ingles-progress-fill', 'ingles-progress-text');
    }

    // --- Funciones de Navegaci√≥n y Contenido ---
    function showSubject(subject) {
      if (!isAuthenticated) {
        showMessage('Por favor, inicia sesi√≥n para acceder a las materias.');
        showAuthModal(); // Show auth modal if not authenticated
        return;
      }
      // Ocultar contenido principal, quiz y otras p√°ginas de asignatura
      hideAuthModal();
      document.getElementById('main-content').classList.add('hidden');
      document.getElementById('quiz-container').classList.add('hidden');
      document.querySelectorAll('.subject-page').forEach(page => {
        page.classList.remove('active');
        page.classList.add('hidden'); // Asegurarse de que est√©n ocultas
      });
      lessonContentDisplay.classList.add('hidden'); // Asegurarse que la lecci√≥n est√© oculta

      // Mostrar p√°gina de la asignatura
      const subjectPage = document.getElementById(subject + '-page');
      if (subjectPage) {
        subjectPage.classList.remove('hidden');
        subjectPage.classList.add('active');
      }
      
      // Personalizar introducci√≥n seg√∫n el estilo de aprendizaje
      personalizeSubjectIntro(subject);
      // Actualizar barras de progreso al entrar en la asignatura
      updateAllProgressBars();
      loadProgressAndDisplay(); // Asegurar que los checks est√©n visibles
    }

    function showMainContent() {
      // Ocultar todas las p√°ginas de asignaturas, el cuestionario y el contenido de lecci√≥n
      hideAuthModal();
      document.querySelectorAll('.subject-page').forEach(page => {
        page.classList.remove('active');
        page.classList.add('hidden');
      });
      document.getElementById('quiz-container').classList.add('hidden');
      lessonContentDisplay.classList.add('hidden'); // Asegurarse que la lecci√≥n est√© oculta
      
      // Mostrar contenido principal
      document.getElementById('main-content').classList.remove('hidden');
    }

    function personalizeSubjectIntro(subject) {
      const introElement = document.getElementById(subject + '-personalized-intro');
      if (!introElement) return;

      const personalizedIntros = {
        matematicas: {
          visual: "üé® Como eres una persona con estilo **visual**, hemos preparado esquemas, gr√°ficos y representaciones visuales para cada tema de matem√°ticas. ¬°Ver√°s las matem√°ticas de una forma completamente nueva!",
          auditivo: "üîä Perfecto para tu estilo **auditivo**: cada lecci√≥n incluye explicaciones paso a paso, podcasts matem√°ticos y ejercicios que puedes resolver 'hablando' contigo mismo.",
          'lectura-escritura': "üìù Ideal para tu estilo de **lectura/escritura**: encontrar√°s res√∫menes detallados, ejercicios escritos y la posibilidad de tomar notas estructuradas en cada tema.",
          kinestesico: "üèÉ ¬°Matem√°ticas en movimiento! Hemos dise√±ado actividades pr√°cticas, manipulativas y ejercicios que puedes resolver movi√©ndote o usando objetos f√≠sicos."
        },
        lengua: {
          visual: "üé® Tu aprendizaje **visual** te ayudar√° con mapas mentales, esquemas de sintaxis y representaciones gr√°ficas de las reglas gramaticales.",
          auditivo: "üîä Perfecto para tu estilo: lecturas en voz alta, ejercicios de dictado, y t√©cnicas de memorizaci√≥n con ritmo y sonidos.",
          'lectura-escritura': "üìù En tu elemento: an√°lisis de textos, ejercicios de escritura creativa y t√©cnicas de estudio basadas en la lectura comprensiva.",
          kinestesico: "üèÉ Lengua activa: dramatizaciones, juegos de roles y ejercicios donde puedas moverte mientras aprendes gram√°tica y literatura."
        },
        ingles: {
          visual: "üé® **Visual English**: flashcards, mind maps, videos y material gr√°fico para aprender vocabulario y gram√°tica de forma visual.",
          auditivo: "üîä Perfect for you: **listening exercises**, pronunciation practice, songs and audio materials to improve your English naturally.",
          'lectura-escritura': "üìù **Reading & Writing** focus: textos graduados, ejercicios de escritura y t√©cnicas de estudio basadas en la lectura en ingl√©s.",
          kinestesico: "üèÉ **Active English**: role-plays, interactive games y actividades pr√°cticas para aprender ingl√©s movi√©ndote y experimentando."
        }
      };

      const intro = personalizedIntros[subject] && personalizedIntros[subject][userLearningStyle];
      if (intro) {
        introElement.innerHTML = `<div style="background: #eef5fb; padding: 25px; border-radius: var(--border-radius); margin-bottom: 30px; border-left: 5px solid var(--secondary-color); font-size: 1.1em; line-height: 1.6; color: var(--text-dark);"><strong>Personalizado para ti:</strong><br>${intro}</div>`;
      }
    }

    // --- Contenido de Lecciones Din√°micas (para diferentes tipos de material) ---
    const topicContents = {
      matematicas: {
        'operaciones-basicas': {
          visual: `
            <h3>Operaciones B√°sicas: Suma y Resta Visualmente</h3>
            <p>Mira este **video explicativo** animado sobre sumas y restas. Observa c√≥mo los n√∫meros se combinan y se separan, haciendo que las operaciones sean m√°s intuitivas.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4' poster='https://via.placeholder.com/600x400?text=Video+Matem√°ticas+Visual'></video>
            <p>Y aqu√≠ tienes un **diagrama de barras** para visualizar la adici√≥n y sustracci√≥n. Cada barra representa una cantidad, y su uni√≥n o separaci√≥n ilustra la operaci√≥n.</p>
            <img src='https://placehold.co/600x300/eef5fb/34495e?text=Diagrama+Barras+Sumas+y+Restas' alt='Diagrama de barras para sumas y restas' style='max-width: 80%;'>
            <p><strong>Ejercicio Visual:</strong> Observa las siguientes im√°genes y escribe la operaci√≥n matem√°tica que representan.</p>
            <img src='https://placehold.co/400x200/eef5fb/34495e?text=Ejercicio+Visual+1' alt='Ejercicio visual de sumas'>
            <textarea rows='2' cols='60' placeholder='Tu respuesta para el ejercicio 1...' style='width: 100%;'></textarea><br>
            <img src='https://placehold.co/400x200/eef5fb/34495e?text=Ejercicio+Visual+2' alt='Ejercicio visual de restas'>
            <textarea rows='2' cols='60' placeholder='Tu respuesta para el ejercicio 2...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"operaciones-basicas\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Operaciones B√°sicas: Escucha y Comprende</h3>
            <p>Escucha con atenci√≥n esta **explicaci√≥n detallada** de c√≥mo se realizan las sumas y restas. Intenta visualizar los n√∫meros mientras escuchas. Puedes cerrar los ojos y concentrarte en el sonido.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> A continuaci√≥n, escuchar√°s varios problemas narrados. Escribe la soluci√≥n de cada uno.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe las soluciones a los problemas escuchados aqu√≠...' style='width: 100%;'></textarea>
            <p><strong>Reto Auditivo:</strong> Repite en voz alta las reglas de la suma y la resta despu√©s de escucharlas para afianzar el conocimiento.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"operaciones-basicas\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Operaciones B√°sicas: Lee, Escribe y Domina</h3>
            <p>Lee el siguiente **documento con la teor√≠a completa** sobre las operaciones b√°sicas (suma, resta, multiplicaci√≥n y divisi√≥n). Presta especial atenci√≥n a las definiciones y ejemplos.</p>
            <p>La **suma** es la operaci√≥n fundamental de combinar dos o m√°s n√∫meros (sumandos) para obtener un total (suma). Se representa con el signo m√°s (+). Por ejemplo, 2 + 3 = 5.</p>
            <p>La **resta** es la operaci√≥n inversa de la suma, donde se quita una cantidad (sustraendo) de otra (minuendo) para encontrar la diferencia. Se representa con el signo menos (-). Por ejemplo, 5 - 2 = 3.</p>
            <p>La **multiplicaci√≥n** es la suma repetida de un n√∫mero. Por ejemplo, 3 x 4 significa sumar 3 cuatro veces (3+3+3+3 = 12). Se representa con (x) o (*).</p>
            <p>La **divisi√≥n** es la operaci√≥n de repartir una cantidad en partes iguales. Por ejemplo, 10 √∑ 2 = 5, significa que 10 se puede dividir en 2 grupos de 5. Se representa con (√∑) o (/).</p>
            <p><strong>Ejercicio Escrito:</strong> Resuelve los siguientes problemas y explica tus pasos. No olvides tomar notas.</p>
            <ol>
                <li>Un autob√∫s sale con 15 pasajeros y suben 8 m√°s. ¬øCu√°ntos pasajeros hay ahora?</li>
                <li>Tienes 25 euros y gastas 12 en un libro. ¬øCu√°nto dinero te queda?</li>
                <li>Si cada caja tiene 6 manzanas y tienes 4 cajas, ¬øcu√°ntas manzanas tienes en total?</li>
                <li>Tienes 20 caramelos y quieres repartirlos entre 5 amigos por igual. ¬øCu√°ntos caramelos recibe cada uno?</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Toma tus propias notas, resuelve los ejercicios y explica tus razonamientos aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"operaciones-basicas\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Operaciones B√°sicas: Aprende Haciendo</h3>
            <p>¬°Es hora de poner las manos en la masa! Resuelve problemas interactivos donde **arrastrar√°s y soltar√°s** los n√∫meros en el lugar correcto para completar las sumas y restas. ¬°Siente las matem√°ticas mientras las creas!</p>
            <div class='interactive-game-placeholder'>
              <p>Aqu√≠ ir√≠a un juego interactivo de arrastrar y soltar n√∫meros para sumar/restar.</p>
              <p><em>Imagina que tienes "fichas" con n√∫meros que puedes mover a casillas para resolver:</em></p>
              <p>[ ] + [ ] = 5</p>
              <p>8 - [ ] = 3</p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa objetos reales (legos, monedas, l√°pices) para representar las sumas y restas que se te piden. Por ejemplo, junta 3 l√°pices y 2 l√°pices para entender 3+2.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"operaciones-basicas\")'>Simular Completar Juego (¬°Imagina que lo jugaste y lo completaste!)</button>
          `
        },
        'fracciones': {
          visual: `
            <h3>Fracciones y Decimales: Con√©ctate con lo Visual</h3>
            <p>Aprende fracciones y decimales con estas **im√°genes y gr√°ficos de tartas interactivas**. Visualiza c√≥mo se divide el todo en partes y c√≥mo se representan los decimales en una recta num√©rica.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Fracciones+y+Decimales+Visual' alt='Fracciones visual con tartas y recta num√©rica'>
            <p><strong>Video Explicativo:</strong> Mira c√≥mo las fracciones se transforman en decimales y viceversa.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> ¬øQu√© fracci√≥n representa la parte coloreada?</p>
            <img src='https://placehold.co/300x200/eef5fb/34495e?text=Ejercicio+Fraccion+1' alt='Ejercicio de identificar fracci√≥n'>
            <textarea rows='2' cols='60' placeholder='Tu respuesta...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"fracciones\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Fracciones y Decimales: Escucha y Razona</h3>
            <p>Escucha la **explicaci√≥n de fracciones y decimales** y sus operaciones. Intenta escuchar c√≥mo se relacionan los conceptos y c√≥mo se pronuncian correctamente.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <p><strong>Podcast Educativo:</strong> Un episodio sobre la importancia de las fracciones en la vida diaria.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Escucha los problemas y calcula las respuestas. Luego, repite en voz alta las soluciones.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe tus soluciones aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"fracciones\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Fracciones y Decimales: Aprende Leyendo y Escribiendo</h3>
            <p>Lee la **teor√≠a completa de fracciones y decimales**. Presta atenci√≥n a las definiciones, propiedades y c√≥mo se realizan las operaciones b√°sicas con ellos. Toma notas y subraya lo importante.</p>
            <p>Una **fracci√≥n** es un n√∫mero que representa una parte de un todo dividido en partes iguales. Est√° compuesta por un **numerador** (la parte de arriba, que indica cu√°ntas partes se toman) y un **denominador** (la parte de abajo, que indica en cu√°ntas partes se divide el todo).</p>
            <p>Un **n√∫mero decimal** es una forma de representar n√∫meros no enteros, es decir, n√∫meros que tienen una parte entera y una parte fraccionaria. Se separan por una coma o un punto (ej: 3,14).</p>
            <p><strong>Ejercicio Escrito:</strong> Resuelve los siguientes ejercicios. Escribe cada paso de tu soluci√≥n.</p>
            <ol>
                <li>Convertir 3/4 a decimal.</li>
                <li>Convertir 0.75 a fracci√≥n.</li>
                <li>Calcular 1/2 + 1/4.</li>
                <li>Calcular 1.5 * 2.3.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Toma tus propias notas, resuelve y explica aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"fracciones\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Fracciones y Decimales: Manos a la Obra</h3>
            <p>¬°Juega al **rompecabezas de fracciones**! Tendr√°s que arrastrar piezas para formar fracciones completas y luego convertirlas a decimales. ¬°Siente c√≥mo las partes encajan para formar el todo!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de construcci√≥n de fracciones y conversi√≥n a decimales.</p>
              <p><em>Imagina que arrastras 3 piezas de 1/4 para formar 3/4 y luego escribes 0.75.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa una naranja o una pizza de juguete para dividirla en partes iguales y representar fracciones. Corta la naranja en 4, quita una parte y visualiza 3/4.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"fracciones\")'>Simular Completar Juego</button>
          `
        },
        'porcentajes': {
          visual: `
            <h3>Porcentajes: Infograf√≠as y Gr√°ficos Claros</h3>
            <p>Visualiza c√≥mo funcionan los porcentajes con **infograf√≠as y barras de progreso**. Entender√°s de un vistazo qu√© significa un 25% o un 75%.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Infografia+Porcentajes' alt='Infograf√≠a de porcentajes'>
            <p><strong>Video:</strong> Ejemplos reales de porcentajes en la vida cotidiana (descuentos, impuestos).</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> ¬øQu√© porcentaje representa la parte sombreada?</p>
            <img src='https://placehold.co/300x200/eef5fb/34495e?text=Ejercicio+Porcentaje+1' alt='Ejercicio visual de porcentaje'>
            <textarea rows='2' cols='60' placeholder='Tu respuesta...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"porcentajes\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Porcentajes: Escucha la L√≥gica</h3>
            <p>Escucha la **l√≥gica detr√°s de los porcentajes** y ejemplos pr√°cticos hablados. Se te guiar√° paso a paso para calcular aumentos, descuentos y partes de un todo.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <p><strong>Actividad Auditiva:</strong> Escucha los siguientes escenarios de compra y venta, y calcula mentalmente los porcentajes o descuentos.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Tus c√°lculos y respuestas aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"porcentajes\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Porcentajes: Calcula y Explica</h3>
            <p>Domina el **c√°lculo de porcentajes** leyendo y resolviendo problemas paso a paso. Se te proporcionar√°n f√≥rmulas y ejemplos detallados.</p>
            <p>Para calcular un porcentaje de una cantidad, se multiplica la cantidad por el porcentaje y se divide entre 100. Por ejemplo, el 20% de 50 es (20 * 50) / 100 = 10.</p>
            <p>Para calcular un aumento porcentual, se suma el porcentaje de la cantidad original a la cantidad original. Para un descuento, se resta.</p>
            <p><strong>Ejercicio Escrito:</strong> Resuelve los siguientes problemas, mostrando todos tus pasos.</p>
            <ol>
                <li>¬øCu√°l es el 15% de 300?</li>
                <li>Un art√≠culo que cuesta 80‚Ç¨ tiene un 25% de descuento. ¬øCu√°l es el precio final?</li>
                <li>Si el precio de la gasolina subi√≥ un 5% y antes costaba 1.50‚Ç¨/litro, ¬øcu√°nto cuesta ahora?</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Escribe tus propias f√≥rmulas, c√°lculos y ejemplos de porcentajes aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"porcentajes\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Porcentajes: Simula y Aplica</h3>
            <p>Aplica descuentos y aumentos en una **simulaci√≥n interactiva de compras**. Ser√°s el cajero y calcular√°s los precios finales, manejando dinero virtual. ¬°Aprende mientras \"vendes\"!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de c√°lculo de porcentajes en un escenario de tienda.</p>
              <p><em>Imagina que arrastras el bot√≥n de \"20% descuento\" al precio de un producto.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa billetes de juguete o papel para representar diferentes cantidades y calcula los porcentajes manualmente, quitando o a√±adiendo billetes.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"porcentajes\")'>Simular Completar Juego</button>
          `
        },
        'ecuaciones': {
          visual: `
            <h3>Ecuaciones de Primer Grado: Balance Visual</h3>
            <p>Observa c√≥mo se balancean las ecuaciones con un **simulador de balanza**. Cada lado de la ecuaci√≥n es un platillo, y al mover elementos, ver√°s c√≥mo se mantiene o se rompe el equilibrio.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Ecuaciones+Balanza+Visual' alt='Simulador de balanza para ecuaciones'>
            <p><strong>Video Animado:</strong> Un profesor explica las ecuaciones usando animaciones que te ayudar√°n a entender el concepto de inc√≥gnita.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Completa los diagramas de flujo para resolver la ecuaci√≥n paso a paso.</p>
            <img src='https://placehold.co/400x300/eef5fb/34495e?text=Diagrama+Flujo+Ecuaciones' alt='Diagrama de flujo de ecuaciones'>
            <textarea rows='3' cols='60' placeholder='Completa el diagrama con tus pasos...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"ecuaciones\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Ecuaciones de Primer Grado: Gu√≠a Auditiva</h3>
            <p>Escucha una **gu√≠a paso a paso para resolver ecuaciones** de primer grado. Presta atenci√≥n a las instrucciones y a la l√≥gica detr√°s de cada operaci√≥n. Puedes repetirlo para interiorizar los pasos.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <p><strong>Podcast:</strong> Un episodio sobre "La historia de la X" en las matem√°ticas y c√≥mo se usan las ecuaciones.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Se te dictar√° una ecuaci√≥n y deber√°s resolverla y decir la soluci√≥n en voz alta.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe la soluci√≥n y explica tus pasos aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"ecuaciones\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Ecuaciones de Primer Grado: Resuelve Escribiendo</h3>
            <p>Sigue los **ejemplos resueltos** de ecuaciones de primer grado y practica escribiendo tus propias soluciones. La teor√≠a y la pr√°ctica se unen para que domines el tema.</p>
            <p>Una **ecuaci√≥n de primer grado** es una igualdad matem√°tica que tiene una o m√°s inc√≥gnitas (generalmente representadas por 'x') elevadas a la primera potencia. El objetivo es encontrar el valor de la inc√≥gnita.</p>
            <p><strong>Pasos para resolver:</strong></p>
            <ol>
                <li>Agrupar los t√©rminos con la inc√≥gnita en un lado y los n√∫meros en el otro.</li>
                <li>Realizar las operaciones de suma o resta.</li>
                <li>Despejar la inc√≥gnita dividiendo por el coeficiente que la acompa√±a.</li>
            </ol>
            <p><strong>Ejemplo:</strong> 2x + 5 = 15</p>
            <p>2x = 15 - 5</p>
            <p>2x = 10</p>
            <p>x = 10 / 2</p>
            <p>x = 5</p>
            <p><strong>Ejercicios Escritos:</strong> Resuelve las siguientes ecuaciones, mostrando todos los pasos.</p>
            <ol>
                <li>3x - 7 = 8</li>
                <li>5 + x = 12</li>
                <li>4x = 20</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Resuelve las ecuaciones paso a paso aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"ecuaciones\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Ecuaciones de Primer Grado: El Juego de la X</h3>
            <p>¬°Mueve t√©rminos y resuelve ecuaciones con un **juego de \"resolver la X\"**! Arrastra los n√∫meros y las inc√≥gnitas de un lado a otro para despejar la 'X'. ¬°Siente la balanza moverse a tu favor!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo donde arrastras t√©rminos para resolver ecuaciones.</p>
              <p><em>Imagina que arrastras el '-5' de un lado a otro, cambiando a '+5'.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa fichas de dos colores (uno para n√∫meros, otro para inc√≥gnitas) para representar la ecuaci√≥n en tu mesa. Mueve las fichas f√≠sicamente para entender c√≥mo se despeja la 'X'.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"ecuaciones\")'>Simular Completar Juego</button>
          `
        },
        'sistemas': {
          visual: `
            <h3>Sistemas de Ecuaciones: Gr√°ficas que Aclaran</h3>
            <p>Visualiza las soluciones de sistemas de ecuaciones con **gr√°ficas interactivas**. Observa c√≥mo dos l√≠neas se cruzan en un punto, que es la soluci√≥n al sistema. ¬°Ver√°s las matem√°ticas cobrar vida!</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Sistemas+Graficas+Visual' alt='Gr√°ficas de sistemas de ecuaciones'>
            <p><strong>Video Explicativo:</strong> Animaciones que muestran c√≥mo los m√©todos de sustituci√≥n, igualaci√≥n y reducci√≥n funcionan paso a paso.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Identifica la soluci√≥n del sistema observando la gr√°fica.</p>
            <img src='https://placehold.co/400x300/eef5fb/34495e?text=Ejercicio+Sistema+Visual' alt='Ejercicio de identificar soluci√≥n de sistema'>
            <textarea rows='2' cols='60' placeholder='Cu√°l es la soluci√≥n (X,Y)?' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"sistemas\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Sistemas de Ecuaciones: Escucha los M√©todos</h3>
            <p>Escucha la **explicaci√≥n de los m√©todos** (sustituci√≥n, igualaci√≥n y reducci√≥n) para sistemas de ecuaciones. Conc√©ntrate en la secuencia de pasos de cada m√©todo.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <p><strong>Gu√≠a en Audio:</strong> Una descripci√≥n auditiva de cu√°ndo es mejor usar cada m√©todo de resoluci√≥n de sistemas.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Se te dictar√° un sistema. Escucha atentamente y elige el mejor m√©todo para resolverlo, luego da la soluci√≥n.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Tu soluci√≥n y m√©todo elegido...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"sistemas\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Sistemas de Ecuaciones: Resuelve y Documenta</h3>
            <p>Estudia los **m√©todos para resolver sistemas de ecuaciones** y practica con ejercicios escritos. Documenta cada paso detalladamente para consolidar tu aprendizaje.</p>
            <p>Un **sistema de ecuaciones** es un conjunto de dos o m√°s ecuaciones con varias inc√≥gnitas, donde buscamos los valores de las inc√≥gnitas que satisfacen todas las ecuaciones simult√°neamente.</p>
            <p><strong>M√©todos principales:</strong></p>
            <ul>
                <li><strong>Sustituci√≥n:</strong> Despejar una inc√≥gnita de una ecuaci√≥n y sustituirla en la otra.</li>
                <li><strong>Igualaci√≥n:</strong> Despejar la misma inc√≥gnita de ambas ecuaciones e igualar las expresiones.</li>
                <li><strong>Reducci√≥n:</strong> Multiplicar las ecuaciones por n√∫meros para que, al sumarlas o restarlas, se elimine una inc√≥gnita.</li>
            </ul>
            <p><strong>Ejercicio Escrito:</strong> Resuelve el siguiente sistema por el m√©todo que prefieras, mostrando todos los pasos.</p>
            <p>x + y = 5</p>
            <p>2x - y = 1</p>
            <textarea rows='10' cols='60' placeholder='Resuelve el sistema paso a paso aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"sistemas\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Sistemas de Ecuaciones: Un simulador de Juego</h3>
            <p>Usa un **simulador interactivo** para practicar la resoluci√≥n de sistemas de ecuaciones. Podr√°s arrastrar y soltar ecuaciones, combinar t√©rminos y ver los resultados en tiempo real.</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de resoluci√≥n de sistemas, donde manipulas las ecuaciones.</p>
              <p><em>Imagina un juego donde arrastras 'x' y 'y' para eliminarlas o sustituirlas.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Crea tus propias ecuaciones con bloques o fichas y "resuelve" el sistema moviendo los bloques hasta encontrar la soluci√≥n.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"sistemas\")'>Simular Completar Juego</button>
          `
        },
        'geometria': {
          visual: `
            <h3>Geometr√≠a B√°sica: Formas y Medidas en Acci√≥n</h3>
            <p>Explora las figuras geom√©tricas con **modelos 3D interactivos** y diagramas. Rota las figuras, observa sus caras, aristas y v√©rtices para una comprensi√≥n espacial completa.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Geometria+3D+Visual' alt='Modelos 3D de figuras geom√©tricas'>
            <p><strong>Video Tutorial:</strong> C√≥mo calcular √°reas y per√≠metros de cuadrados, c√≠rculos y tri√°ngulos, con animaciones que muestran las f√≥rmulas.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Dibuja la figura que se te pide y anota sus propiedades.</p>
            <img src='https://placehold.co/400x300/eef5fb/34495e?text=Dibuja+un+C√≠rculo' alt='Espacio para dibujar'>
            <textarea rows='3' cols='60' placeholder='Dibuja y anota las propiedades aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"geometria\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Geometr√≠a B√°sica: Descripciones Auditivas</h3>
            <p>Escucha las **descripciones y propiedades** de las figuras geom√©tricas b√°sicas. Cierra los ojos y trata de visualizar la figura mientras escuchas sus caracter√≠sticas.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <p><strong>Actividad Auditiva:</strong> Se te describir√° una figura. Intenta identificarla solo por la descripci√≥n y luego escribe su nombre y sus f√≥rmulas.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Identifica la figura y escribe sus f√≥rmulas...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"geometria\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Geometr√≠a B√°sica: F√≥rmulas y Problemas Escritos</h3>
            <p>Aprende las **f√≥rmulas de √°rea, per√≠metro y volumen** escribi√©ndolas y aplic√°ndolas en problemas. Lee la teor√≠a y resuelve ejercicios para dominar la geometr√≠a.</p>
            <p><strong>F√≥rmulas clave:</strong></p>
            <ul>
                <li><strong>Cuadrado:</strong> √Årea = lado * lado; Per√≠metro = 4 * lado</li>
                <li><strong>Rect√°ngulo:</strong> √Årea = base * altura; Per√≠metro = 2 * (base + altura)</li>
                <li><strong>C√≠rculo:</strong> √Årea = œÄ * radio¬≤; Per√≠metro (Circunferencia) = 2 * œÄ * radio</li>
                <li><strong>Tri√°ngulo:</strong> √Årea = (base * altura) / 2</li>
            </ul>
            <p><strong>Ejercicio Escrito:</strong> Calcula el √°rea y el per√≠metro de las siguientes figuras, mostrando tus operaciones.</p>
            <ol>
                <li>Un cuadrado con lado 5 cm.</li>
                <li>Un rect√°ngulo con base 8 cm y altura 3 cm.</li>
                <li>Un c√≠rculo con radio 4 cm (usa œÄ = 3.14).</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Dibuja y anota las f√≥rmulas de geometr√≠a aqu√≠ y resuelve los problemas...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"matematicas\", \"geometria\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Geometr√≠a B√°sica: Construye y Mide</h3>
            <p>Construye figuras geom√©tricas con **piezas virtuales** (o reales si tienes a mano) y calcula sus propiedades. ¬°Siente la forma de un cubo al manipular sus partes!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de construcci√≥n geom√©trica donde arrastras y unes formas.</p>
              <p><em>Imagina que unes 6 cuadrados para formar un cubo y luego calculas su volumen.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa papel y tijeras para construir tus propias figuras 2D y 3D (cuadrados, cubos, cilindros). Mide sus lados y calcula sus √°reas y vol√∫menes.</p>
            <button onclick='simulateGameCompletion(\"matematicas\", \"geometria\")'>Simular Completar Juego</button>
          `
        }
      },
      lengua: {
        'ortografia-basica': {
          visual: `
            <h3>Ortograf√≠a B√°sica: Mapas Mentales y Colores</h3>
            <p>Observa los **mapas mentales de reglas ortogr√°ficas** y usa colores para recordar las normas de acentuaci√≥n, la B/V, G/J, y H. ¬°Un vistazo y lo recordar√°s todo!</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Mapa+Mental+Ortograf√≠a' alt='Mapa mental de ortograf√≠a'>
            <p><strong>Video Animado:</strong> Animaciones que explican cu√°ndo usar 'h' o 'b'/'v' con ejemplos gr√°ficos.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Identifica los errores ortogr√°ficos en este texto y subr√°yalos mentalmente.</p>
            <img src='https://placehold.co/500x250/eef5fb/34495e?text=Texto+con+Errores+Ortogr√°ficos' alt='Texto con errores'>
            <textarea rows='3' cols='60' placeholder='Escribe las palabras corregidas aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"ortografia-basica\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Ortograf√≠a B√°sica: Dictados y Sonidos</h3>
            <p>Escucha un **dictado** y compru√©balo, mejorando tu o√≠do ortogr√°fico. Repite las palabras dif√≠ciles en voz alta.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <p><strong>Ejercicios de Pronunciaci√≥n:</strong> Escucha pares de palabras que suenan similar but se escriben diferente (ej: 'hola' vs 'ola', 'vaca' vs 'baca') y dist√≠nguelas.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <p><strong>Actividad Auditiva:</strong> Escucha esta lista de palabras y escribe solo aquellas que lleven tilde. Luego verifica la ortograf√≠a.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe las palabras con tilde aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"ortografia-basica\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Ortograf√≠a B√°sica: Reglas y Ejercicios Escritos</h3>
            <p>Lee las **reglas ortogr√°ficas fundamentales** (acentuaci√≥n, uso de B/V, G/J, H, R/RR) y practica con ejercicios de rellenar huecos. Corrige tus errores en texto para afianzar el aprendizaje.</p>
            <p><strong>Reglas de acentuaci√≥n:</strong> Las palabras agudas llevan tilde si terminan en vocal, N o S. Las llanas si NO terminan en vocal, N o S. Las esdr√∫julas y sobresdr√∫julas SIEMPRE llevan tilde.</p>
            <p><strong>Uso de B y V:</strong> Se escribe B antes de L o R (ej: blanco, brazo). Se escribe V despu√©s de N o D (ej: inventar, advertir).</p>
            <p><strong>Ejercicios Escritos:</strong> Completa las siguientes oraciones con la letra correcta (b/v, g/j, h) o pon tilde donde corresponda.</p>
            <ol>
                <li>El _(b/v)olumen del li_(b/v)ro es _(b/v)ajo.</li>
                <li>Mi _(h)ermano _(g/j)uega en el _(g/j)imnasio.</li>
                <li>Este es un ar_ol.</li>
                <li>Ella camina rapido.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Resuelve los ejercicios y explica las reglas aplicadas aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"ortografia-basica\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Ortograf√≠a B√°sica: Juego de Ordenar Letras</h3>
            <p>¬°Juego de **ordenar letras** para formar palabras correctas! Arrastra las letras para construir la palabra con la ortograf√≠a adecuada. ¬°Siente la palabra mientras la construyes y la colocas en su lugar!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de ortograf√≠a: arrastra letras para formar palabras.</p>
              <p><em>Imagina que tienes las letras "o", "l", "h", "a" y las arrastras para formar "hola".</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Usa imanes con letras o tarjetas para formar palabras. Corrige la ortograf√≠a moviendo f√≠sicamente las letras equivocadas y reemplaz√°ndolas.</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"ortografia-basica\")'>Simular Completar Juego</button>
          `
        },
        'morfologia': {
          visual: `
            <h3>Morfolog√≠a: Diagramas y Categor√≠as con Color</h3>
            <p>Identifica las categor√≠as gramaticales con **diagramas de flujo y colores**. Asocia cada tipo de palabra (sustantivo, adjetivo, verbo) con un color y una estructura visual para recordarlo f√°cilmente.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Diagrama+Morfologia' alt='Diagrama de morfolog√≠a'>
            <p><strong>Video Explicativo:</strong> Un video animado que descompone oraciones en sus componentes morfol√≥gicos, mostrando cada palabra con su funci√≥n.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Observa la oraci√≥n y subraya mentalmente (o dibuja c√≠rculos alrededor) de los sustantivos de azul, los verbos de rojo, etc.</p>
            <p><em>"El perro **corre** felizmente en el **parque**."</em></p>
            <textarea rows='3' cols='60' placeholder='Clasifica las palabras destacadas aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"morfologia\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Morfolog√≠a: Escucha y Clasifica</h3>
            <p>Escucha **ejemplos y explicaciones de las categor√≠as gramaticales**. Presta atenci√≥n a c√≥mo suenan las palabras seg√∫n su funci√≥n en la oraci√≥n.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <p><strong>Podcast:</strong> Un episodio sobre la evoluci√≥n de las palabras y c√≥mo cambiaron sus formas a lo largo del tiempo.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Escucha esta lista de palabras. Para cada una, di en voz alta si es un sustantivo, adjetivo o verbo.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe tu clasificaci√≥n aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"morfologia\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Morfolog√≠a: Define y Analiza Escrito</h3>
            <p>Analiza y clasifica palabras en este **ejercicio escrito**. Define cada categor√≠a gramatical y luego aplica tus conocimientos para identificarla en oraciones.</p>
            <p>Las **categor√≠as gramaticales** (o clases de palabras) son grupos en los que se clasifican las palabras de una lengua seg√∫n su funci√≥n y propiedades.</p>
            <ul>
                <li>**Sustantivo:** Nombra personas, animales, cosas, ideas (ej: mesa, Juan, amor).</li>
                <li>**Verbo:** Expresa acciones, estados o procesos (ej: correr, ser, existir).</li>
                <li>**Adjetivo:** Califica al sustantivo (ej: grande, bonita, rojo).</li>
                <li>**Adverbio:** Modifica a un verbo, un adjetivo o a otro adverbio (ej: r√°pidamente, muy, aqu√≠).</li>
                <li>**Determinante:** Acompa√±a al sustantivo para especificarlo (ej: el, una, mi).</li>
                <li>**Pronombre:** Sustituye al sustantivo (ej: yo, √©l, este).</li>
            </ul>
            <p><strong>Ejercicio Escrito:</strong> Identifica la categor√≠a gramatical de cada palabra en la siguiente oraci√≥n.</p>
            <p><em>"La peque√±a ni√±a jugaba alegremente en el jard√≠n."</em></p>
            <textarea rows='10' cols='60' placeholder='Analiza cada palabra aqu√≠ (ej: La: determinante, peque√±a: adjetivo...)' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"morfologia\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Morfolog√≠a: Clasifica y Mueve</h3>
            <p>**Clasifica palabras** arrastr√°ndolas a su categor√≠a correcta en un juego interactivo. ¬°Siente c√≥mo cada palabra encuentra su lugar en la estructura de la oraci√≥n!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de clasificaci√≥n morfol√≥gica: arrastra palabras a sus categor√≠as.</p>
              <p><em>Imagina que arrastras la palabra "correr" a la caja "Verbos".</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Escribe diferentes palabras en tarjetas de colores (un color por categor√≠a). Mezcla las tarjetas y luego sep√°ralas en montones seg√∫n su categor√≠a gramatical. ¬°Hazlo r√°pido!</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"morfologia\")'>Simular Completar Juego</button>
          `
        },
        'sintaxis-simple': {
          visual: `
            <h3>Sintaxis - Oraci√≥n Simple: Esquemas y Estructuras</h3>
            <p>Entiende la estructura de la oraci√≥n con **esquemas de an√°lisis sint√°ctico visuales**. Cada elemento (sujeto, predicado, complementos) tendr√° su propio espacio y conexi√≥n visual.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Esquema+Sintaxis+Simple' alt='Esquema de sintaxis simple'>
            <p><strong>Video Animado:</strong> Animaciones que descomponen oraciones y muestran c√≥mo se relacionan el sujeto y el predicado.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Dibuja el esquema de la oraci√≥n y rellena los componentes.</p>
            <p><em>"Los ni√±os felices juegan en el parque."</em></p>
            <textarea rows='5' cols='60' placeholder='Dibuja el esquema y clasifica aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-simple\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Sintaxis - Oraci√≥n Simple: An√°lisis Auditivo</h3>
            <p>Escucha el **an√°lisis de oraciones simples** explicado paso a paso. Se te dictar√°n oraciones y se te guiar√° para identificar el sujeto, el predicado y sus complementos.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <p><strong>Actividad Auditiva:</strong> Escucha esta oraci√≥n y di en voz alta cu√°l es el sujeto y cu√°l el predicado.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe tu an√°lisis auditivo aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-simple\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Sintaxis - Oraci√≥n Simple: Analiza por Escrito</h3>
            <p>Practica el **an√°lisis sint√°ctico** de oraciones simples escribiendo sus componentes. Lee las definiciones de sujeto, predicado y complementos, y aplica la teor√≠a.</p>
            <p>La **oraci√≥n simple** es aquella que tiene un solo verbo en forma personal. Sus dos partes principales son el **Sujeto** (quien realiza o de quien se dice algo) y el **Predicado** (lo que hace o se dice del sujeto).</p>
            <p><strong>Complementos del predicado:</strong></p>
            <ul>
                <li>**Objeto Directo (OD):** Qu√© o a qui√©n.</li>
                <li>**Objeto Indirecto (OI):** A qui√©n o para qui√©n.</li>
                <li>**Complemento Circunstancial (CC):** C√≥mo, cu√°ndo, d√≥nde, cu√°nto, etc.</li>
            </ul>
            <p><strong>Ejercicios Escritos:</strong> Analiza sint√°cticamente las siguientes oraciones, identificando sujeto, predicado y complementos.</p>
            <ol>
                <li>Mar√≠a compr√≥ un libro ayer.</li>
                <li>Los p√°jaros cantan en el √°rbol.</li>
                <li>Juan dio flores a su madre.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Analiza cada oraci√≥n paso a paso aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-simple\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Sintaxis - Oraci√≥n Simple: Construye Oraciones</h3>
            <p>**Construye oraciones** arrastrando los componentes (sujeto, predicado, complementos) a su lugar en un juego interactivo. ¬°Siente c√≥mo se forma una oraci√≥n al unir sus partes!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de construcci√≥n sint√°ctica: arrastra cajas de palabras para formar oraciones correctas.</p>
              <p><em>Imagina que arrastras "El perro" a la caja de "Sujeto", y "ladra mucho" a la caja de "Predicado".</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Escribe en tarjetas diferentes palabras (sustantivos, verbos, adjetivos, etc.). Luego, juega a construir oraciones variadas, moviendo las tarjetas para cambiar el orden o a√±adir complementos.</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-simple\")'>Simular Completar Juego</button>
          `
        },
        'sintaxis-compuesta': {
          visual: `
            <h3>Sintaxis - Oraci√≥n Compuesta: Mapas y Redes</h3>
            <p>Visualiza los tipos de oraciones compuestas con **diagramas de subordinaci√≥n y coordinaci√≥n** y redes de relaciones entre proposiciones. Entender√°s la complejidad de las frases de un vistazo.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Mapa+Sintaxis+Compuesta' alt='Mapa de sintaxis compuesta'>
            <p><strong>Video:</strong> Animaciones que explican las oraciones coordinadas (copulativas, disyuntivas, adversativas) y subordinadas (sustantivas, adjetivas, adverbiales).</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Observa la oraci√≥n y dibuja las "cajas" para cada proposici√≥n y las flechas para indicar su relaci√≥n.</p>
            <p><em>"Estudiar√© mucho para que apruebe el examen."</em></p>
            <textarea rows='5' cols='60' placeholder='Dibuja el esquema y clasifica las proposiciones aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-compuesta\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Sintaxis - Oraci√≥n Compuesta: Explicaciones Auditivas</h3>
            <p>Escucha **ejemplos y explicaciones de oraciones coordinadas y subordinadas**. Presta atenci√≥n a las conjunciones y a c√≥mo cada proposici√≥n se relaciona con la otra.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <p><strong>Podcast:</strong> Un episodio que explora la importancia de las oraciones compuestas para la riqueza del lenguaje.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Escucha esta oraci√≥n. ¬øEs coordinada o subordinada? ¬øDe qu√© tipo?</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe tu clasificaci√≥n y justificaci√≥n aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-compuesta\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Sintaxis - Oraci√≥n Compuesta: Clasifica y Analiza</h3>
            <p>**Clasifica y analiza** oraciones compuestas en este ejercicio escrito. Lee las definiciones de coordinaci√≥n y subordinaci√≥n, y aplica las reglas para desglosar la estructura compleja de las frases.</p>
            <p>La **oraci√≥n compuesta** tiene dos o m√°s verbos, lo que significa que est√° formada por dos o m√°s proposiciones.</p>
            <ul>
                <li>**Oraciones coordinadas:** Proposiciones que son sint√°cticamente independientes entre s√≠, unidas por conjunciones (y, o, pero...).</li>
                <li>**Oraciones subordinadas:** Proposiciones que dependen sint√°cticamente de una principal (sustantivas, adjetivas, adverbiales).</li>
            </ul>
            <p><strong>Ejercicios Escritos:</strong> Clasifica y analiza las siguientes oraciones compuestas.</p>
            <ol>
                <li>Ella canta y √©l baila.</li>
                <li>No s√© si vendr√° ma√±ana.</li>
                <li>Fuimos al parque que est√° cerca de casa.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Analiza cada oraci√≥n, identificando el tipo de proposici√≥n y su funci√≥n...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-compuesta\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Sintaxis - Oraci√≥n Compuesta: Une y Relaciona</h3>
            <p>**Une oraciones simples** para formar compuestas en un juego interactivo. Arrastra las proposiciones y los nexos (conjunciones) para construir oraciones complejas. ¬°Siente c√≥mo las ideas se conectan!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de uni√≥n de oraciones: arrastra proposiciones y nexos.</p>
              <p><em>Imagina que arrastras "Pedro estudia" y "Juan trabaja" y los unes con "y".</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Escribe diferentes oraciones simples en tarjetas separadas. Luego, √∫nelas con tarjetas de conjunciones (y, o, porque, si) para crear oraciones compuestas. Explica en voz alta por qu√© las uniste as√≠.</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"sintaxis-compuesta\")'>Simular Completar Juego</button>
          `
        },
        'literatura': {
          visual: `
            <h3>Literatura Espa√±ola: L√≠neas de Tiempo y Portadas</h3>
            <p>Explora los **g√©neros literarios con infograf√≠as y l√≠neas de tiempo visuales**. Viaja a trav√©s de la historia de la literatura espa√±ola y reconoce a los autores por sus retratos y las portadas de sus obras.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Linea+Tiempo+Literatura' alt='L√≠nea de tiempo de la literatura'>
            <p><strong>Video:</strong> Documental corto sobre la vida y obra de Miguel de Cervantes.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Une con flechas (mentalmente) el autor con su obra m√°s famosa viendo sus im√°genes.</p>
            <img src='https://placehold.co/500x300/eef5fb/34495e?text=Autores+y+Obras' alt='Autores y obras'>
            <textarea rows='3' cols='60' placeholder='Escribe las parejas (Autor - Obra) aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"literatura\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Literatura Espa√±ola: Escucha Fragmentos y Comentarios</h3>
            <p>Escucha **fragmentos de obras cl√°sicas** y comentarios sobre los autores. Cierra los ojos y sum√©rgete en el sonido de la poes√≠a y la prosa espa√±ola.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <p><strong>Audiolibro:</strong> Fragmento de un cl√°sico de la literatura espa√±ola, ideal para familiarizarte con el ritmo y la musicalidad del idioma.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Escucha este fragmento y di en voz alta a qu√© g√©nero literario pertenece y qui√©n podr√≠a ser el autor.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Escribe tus conclusiones aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"literatura\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Literatura Espa√±ola: Analiza Textos y Escribe Comentarios</h3>
            <p>Lee y **analiza textos literarios** y responde preguntas sobre ellos. Aprende sobre los g√©neros literarios, la m√©trica y las figuras ret√≥ricas a trav√©s de la lectura y la escritura de tus propios comentarios.</p>
            <p><strong>G√©neros Literarios:</strong></p>
            <ul>
                <li>**L√≠rica:** Expresa sentimientos y emociones (poes√≠a).</li>
                <li>**Narrativa:** Cuenta una historia (novela, cuento).</li>
                <li>**Dram√°tica:** Destinada a ser representada (teatro).</li>
            </ul>
            <p><strong>Ejemplo de Texto (para analizar):</strong></p>
            <p><em>"Veleta del alma, / ¬ød√≥nde el viento te lleva? / Ni Norte ni Sur, / solo la pena."</em> (Fragmento po√©tico)</p>
            <p><strong>Ejercicio Escrito:</strong> Lee el fragmento y comenta a qu√© g√©nero pertenece, qu√© tema aborda y qu√© emociones transmite.</p>
            <textarea rows='10' cols='60' placeholder='Escribe tu an√°lisis literario aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"literatura\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Literatura Espa√±ola: Juego de Autores y Obras</h3>
            <p>**Arrastra autores a sus obras** correspondientes en un juego de memoria literaria. ¬°Siente la conexi√≥n entre el creador y su creaci√≥n al unirlos!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de arrastrar y soltar: empareja autores con sus obras.</p>
              <p><em>Imagina que arrastras "Cervantes" a "El Quijote".</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Crea tarjetas con nombres de autores y otras con t√≠tulos de obras. Revu√©lvelas y luego empareja las tarjetas f√≠sicamente. Puedes cronometrarte para hacerlo m√°s din√°mico.</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"literatura\")'>Simular Completar Juego</button>
          `
        },
        'expresion-escrita': {
          visual: `
            <h3>Expresi√≥n Escrita: Mapas Conceptuales para Redacci√≥n</h3>
            <p>Organiza tus ideas con **mapas conceptuales para la escritura**. Antes de empezar a redactar, visualiza la estructura de tu texto, las ideas principales y secundarias, y la coherencia de tus argumentos.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Mapa+Conceptual+Redacci√≥n' alt='Mapa conceptual para redacci√≥n'>
            <p><strong>Video Tutorial:</strong> C√≥mo planificar un escrito con un esquema visual, desde la idea principal hasta los detalles.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Ejercicio Visual:</strong> Completa el siguiente mapa conceptual para planificar un texto descriptivo sobre "Mi Lugar Favorito".</p>
            <img src='https://placehold.co/400x300/eef5fb/34495e?text=Esquema+Descriptivo' alt='Esquema para texto descriptivo'>
            <textarea rows='5' cols='60' placeholder='Completa el esquema con tus ideas...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"expresion-escrita\")'>Completar lecci√≥n</button>
          `,
          auditivo: `
            <h3>Expresi√≥n Escrita: Consejos Auditivos para Mejorar</h3>
            <p>Escucha **consejos para mejorar la redacci√≥n** y la coherencia de textos. Aprende a modular tu voz al leer lo que escribes, para detectar errores de ritmo o sentido.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <p><strong>Podcast:</strong> Un episodio sobre la importancia de la voz narrativa y c√≥mo usarla en tus escritos.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <p><strong>Ejercicio Auditivo:</strong> Escucha este p√°rrafo y luego intenta reescribirlo para mejorar su fluidez y claridad.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <textarea rows='5' cols='60' placeholder='Reescribe el p√°rrafo aqu√≠...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"expresion-escrita\")'>Completar lecci√≥n</button>
          `,
          'lectura-escritura': `
            <h3>Expresi√≥n Escrita: Redacta y Revisa</h3>
            <p>Practica diferentes **tipos de texto** (narrativo, descriptivo, expositivo) con ejercicios de redacci√≥n. Lee ejemplos, escribe tus propios textos y revisa la gram√°tica y el estilo.</p>
            <p><strong>Tipos de texto:</strong></p>
            <ul>
                <li>**Narrativo:** Cuenta una historia (cuentos, novelas).</li>
                <li>**Descriptivo:** Detalla caracter√≠sticas de algo o alguien.</li>
                <li>**Expositivo:** Presenta informaci√≥n de forma clara y objetiva.</li>
                <li>**Argumentativo:** Defiende una opini√≥n con razones.</li>
            </ul>
            <p><strong>Ejercicio Escrito:</strong> Escribe un p√°rrafo descriptivo sobre tu lugar favorito. Incluye al menos 5 adjetivos y 2 adverbios.</p>
            <textarea rows='10' cols='60' placeholder='Empieza a escribir aqu√≠ tu p√°rrafo descriptivo...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"lengua\", \"expresion-escrita\")'>Completar lecci√≥n</button>
          `,
          kinestesico: `
            <h3>Expresi√≥n Escrita: Reorganiza y Construye</h3>
            <p>**Reorganiza p√°rrafos** y oraciones para mejorar la fluidez y coherencia de un texto en un juego interactivo. ¬°Siente c√≥mo un texto mejora al mover sus partes!</p>
            <div class='interactive-game-placeholder'>
              <p>Juego interactivo de coherencia textual: arrastra bloques de texto para ordenar un p√°rrafo.</p>
              <p><em>Imagina que tienes frases desordenadas y las arrastras para que el texto tenga sentido.</em></p>
            </div>
            <p><strong>Actividad Pr√°ctica:</strong> Escribe frases o p√°rrafos en tarjetas separadas. M√©zclalas y luego ord√©nalas f√≠sicamente en tu mesa para construir un texto coherente. Lee el resultado en voz alta.</p>
            <button onclick='simulateGameCompletion(\"lengua\", \"expresion-escrita\")'>Simular Completar Juego</button>
          `
        }
      },
      ingles: {
        'basic-vocabulary': {
          visual: `
            <h3>Basic Vocabulary: Flashcards and Picture Dictionaries</h3>
            <p>Learn new words with **interactive flashcards** and picture dictionaries. See the word, its meaning, and an image to create a strong visual connection. Repeat the words as you see them!</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Flashcards+Vocabulary' alt='English flashcards'>
            <p><strong>Video:</strong> Animated vocabulary lessons for common objects and actions.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Visual Exercise:</strong> Look at the picture and write the English word.</p>
            <img src='https://placehold.co/300x200/eef5fb/34495e?text=Apple' alt='Picture of an apple'>
            <textarea rows='2' cols='60' placeholder='Write the word here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"basic-vocabulary\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Basic Vocabulary: Listen and Repeat</h3>
            <p>Listen and **repeat the pronunciation** of basic vocabulary. Focus on the sound of each word and try to imitate it perfectly. Use headphones for best results!</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <p><strong>Audio Exercise:</strong> You will hear a word. Say it out loud and then write it down.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Write the words you hear...' style='width: 100%;'></textarea>
            <p><strong>Pronunciation Challenge:</strong> Record yourself saying the words and compare them to the native speaker.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"basic-vocabulary\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Basic Vocabulary: Read and Write Definitions</h3>
            <p>Read and **write definitions and example sentences** for new words. Create your own vocabulary lists and review them regularly. Pay attention to spelling!</p>
            <p>A **dog** is a domesticated carnivorous mammal that typically has a long snout, an acute sense of smell, and a barking, howling, or whining voice. It is widely kept as a pet or for work purposes.</p>
            <p>A **cat** is a small domesticated carnivorous mammal with soft fur, a short snout, and retractable claws. It is widely kept as a pet or for catching mice and other vermin.</p>
            <p><strong>Writing Exercise:</strong> Write a definition and an example sentence for the following words:</p>
            <ul>
                <li>House</li>
                <li>Book</li>
                <li>Tree</li>
            </ul>
            <textarea rows='10' cols='60' placeholder='Write your definitions and sentences here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"basic-vocabulary\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Basic Vocabulary: Match and Move</h3>
            <p>**Match words to pictures** in a fun drag-and-drop game. Feel the connection as you physically (virtually) unite the word with its image. ¬°Learn by doing!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive vocabulary matching game: drag words to their corresponding images.</p>
              <p><em>Imagina you drag the word "apple" to a picture of an apple.</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Use physical flashcards. Write the word on one side and draw the picture on the other. Then, play a matching game with yourself or a friend.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"basic-vocabulary\")'>Simulate Game Completion</button>
          `
        },
        'present-tenses': {
          visual: `
            <h3>Present Simple & Continuous: Timelines and Actions</h3>
            <p>Understand present tenses with **timeline diagrams and action examples**. See when each tense is used for habits, facts, or ongoing actions right now.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Present+Tenses+Timeline' alt='Present tenses timeline'>
            <p><strong>Video Tutorial:</strong> Animated explanations of verb conjugations in present simple and continuous.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Visual Exercise:</strong> Look at the images and decide if it's Present Simple or Present Continuous.</p>
            <img src='https://placehold.co/300x200/eef5fb/34495e?text=Man+Reading+Daily' alt='Man reading a book daily'>
            <textarea rows='2' cols='60' placeholder='Present Simple or Continuous?' style='width: 100%;'></textarea><br>
            <img src='https://placehold.co/300x200/eef5fb/34495e?text=Woman+Currently+Running' alt='Woman currently running'>
            <textarea rows='2' cols='60' placeholder='Present Simple or Continuous?' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"present-tenses\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Present Simple & Continuous: Listen to Context</h3>
            <p>Listen to **conversations using present simple and continuous** to hear them in context. Pay attention to the adverbs of frequency and time expressions.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <p><strong>Dialogue Practice:</strong> Listen to a dialogue and then record yourself playing one of the characters.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='What did you understand from the dialogue?' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"present-tenses\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Present Simple & Continuous: Fill the Gaps and Write</h3>
            <p>Fill in the blanks and correct sentences to practice **present tenses in writing**. Read the grammar rules carefully and apply them in your exercises.</p>
            <p><strong>Present Simple:</strong> Used for habits, routines, facts. (e.g., *She **works** every day.*)</p>
            <p><strong>Present Continuous:</strong> Used for actions happening now, temporary actions. (e.g., *He **is working** right now.*)</p>
            <p><strong>Writing Exercise:</strong> Complete the sentences with the correct form of the verb in brackets (Present Simple or Present Continuous).</p>
            <ol>
                <li>She (go) _____ to school every day.</li>
                <li>They (play) _____ football now.</li>
                <li>I usually (read) _____ books in the evening.</li>
                <li>Look! The baby (sleep) _____.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Write your answers here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"present-tenses\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Present Simple & Continuous: Form Sentences Actively</h3>
            <p>**Form sentences** by ordering words correctly in present tenses. Drag and drop words to build grammatically correct sentences. Feel the structure!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive sentence builder for present tenses: drag words to form sentences.</p>
              <p><em>Imagina you drag "She" then "is" then "reading" then "a book".</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Use word cards with verbs and adverbs. Physically arrange them to form sentences in Present Simple or Present Continuous. Act out the sentences!</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"present-tenses\")'>Simulate Game Completion</button>
          `
        },
        'past-tenses': {
          visual: `
            <h3>Past Simple & Past Continuous: Visual Narratives</h3>
            <p>See how past events connect with **visual narratives and comics**. Understand the sequence of actions and simultaneous events through illustrations.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Past+Tenses+Comics' alt='Past tenses comics'>
            <p><strong>Video:</strong> Short film illustrating the use of past simple for completed actions and past continuous for ongoing actions.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Visual Exercise:</strong> Describe the story in the pictures using past tenses.</p>
            <img src='https://placehold.co/500x250/eef5fb/34495e?text=Story+Sequence+1' alt='Story sequence 1'>
            <textarea rows='5' cols='60' placeholder='Describe the story in English using past tenses...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"past-tenses\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Past Simple & Past Continuous: Listen to Stories</h3>
            <p>Listen to **stories told in past simple and continuous** and answer comprehension questions. Pay attention to how the tenses are used to describe the flow of events.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <p><strong>Audio Story:</strong> A detective story where you have to follow the events using past tenses.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <p><strong>Exercise:</strong> What was the main character doing when the event happened? Explain based on the audio.</p>
            <textarea rows='3' cols='60' placeholder='Your explanation here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"past-tenses\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Past Simple & Past Continuous: Rewrite and Narrate</h3>
            <p>Read short stories and **rewrite them using past tenses**. Practice conjugating regular and irregular verbs. Pay attention to the time expressions.</p>
            <p><strong>Past Simple:</strong> For completed actions in the past. (e.g., *I **went** to the park yesterday.*)</p>
            <p><strong>Past Continuous:</strong> For ongoing actions in the past, often interrupted by another action. (e.g., *I **was walking** when it started to rain.*)</p>
            <p><strong>Writing Exercise:</strong> Rewrite the following sentences using the correct past tense (Simple or Continuous).</p>
            <ol>
                <li>I (watch) _____ TV when she (call) _____.</li>
                <li>They (live) _____ in London for five years.</li>
                <li>While he (sleep) _____, the phone (ring) _____.</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Rewrite the story in past tense here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"past-tenses\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Past Simple & Past Continuous: Role-Play and Act</h3>
            <p>**Role-play conversations** about past events to practice speaking in past tenses. Act out different scenarios, describing what happened and what you were doing. Get moving and talking!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive role-play for past tenses: simulate a conversation about a past event.</p>
              <p><em>Imagina you are telling a story about your weekend, using past simple and continuous.</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Describe your morning routine using actions. First, do the action, then say the sentence in English using past simple.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"past-tenses\")'>Simulate Game Completion</button>
          `
        },
        'future-tenses': {
          visual: `
            <h3>Future Tenses: Calendars and Planning Diagrams</h3>
            <p>Visualize future plans with **calendars and planning diagrams**. See the difference between planned actions, predictions, and spontaneous decisions through clear visuals.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Future+Plans+Visual' alt='Future plans visual'>
            <p><strong>Video:</strong> Explanations and examples of 'will', 'going to', and present continuous for future, with visual cues.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Visual Exercise:</strong> Create a short comic strip about your plans for next week, using different future tenses.</p>
            <img src='https://placehold.co/500x250/eef5fb/34495e?text=Future+Comic+Strip' alt='Comic strip for future plans'>
            <textarea rows='5' cols='60' placeholder='Write captions for your comic strip using future tenses...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"future-tenses\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Future Tenses: Listen to Plans and Predictions</h3>
            <p>Listen to **dialogues about future plans and predictions**. Pay attention to how native speakers use different future forms naturally.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'></audio>
            <p><strong>Audio Exercise:</strong> Listen to a weather forecast and write down the predictions for the week.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Write the weather predictions here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"future-tenses\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Future Tenses: Describe Your Future</h3>
            <p>Write about your **future plans and predictions** using 'will', 'going to', and present continuous. Practice forming sentences and paragraphs that clearly express future events.</p>
            <p><strong>'Will':</strong> For spontaneous decisions, predictions, promises. (e.g., *I think it **will rain** tomorrow.*)</p>
            <p><strong>'Going to':</strong> For planned actions, predictions based on evidence. (e.g., *I **am going to study** tonight.*)</p>
            <p><strong>Present Continuous:</strong> For fixed arrangements in the near future. (e.g., *We **are meeting** at 7 PM.*)</p>
            <p><strong>Writing Exercise:</strong> Describe your plans for next weekend (at least 5 sentences) using 'will' and 'going to'.</p>
            <textarea rows='10' cols='60' placeholder='Describe your future plans here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"future-tenses\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Future Tenses: Plan a Virtual Trip</h3>
            <p>**Plan a virtual trip** by choosing activities and forming sentences in future tenses. Drag and drop places, activities, and times to build your itinerary. ¬°Feel like you're already there!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive future planning game: select destinations and activities.</p>
              <p><em>Imagina you click on "Paris" and then drag "visit Eiffel Tower" to your itinerary.</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Write your future plans on sticky notes. Arrange them on a wall or board, creating a visual timeline of your future actions. Speak each plan out loud as you place it.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"future-tenses\")'>Simulate Game Completion</button>
          `
        },
        'conditionals': {
          visual: `
            <h3>Conditionals: If-Then Diagrams and Flowcharts</h3>
            <p>Understand conditionals with **if-then diagrams and flowcharts**. See the cause-and-effect relationship visually for zero, first, second, and third conditionals.</p>
            <img src='https://placehold.co/600x400/eef5fb/34495e?text=Conditionals+Flowchart' alt='Conditionals flowchart'>
            <p><strong>Video Explainer:</strong> Animations demonstrating different conditional situations and their grammatical structures.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4'></video>
            <p><strong>Visual Exercise:</strong> Match the beginning of the sentence with the correct ending, using visual cues.</p>
            <img src='https://placehold.co/500x250/eef5fb/34495e?text=Conditional+Matching' alt='Conditional matching exercise'>
            <textarea rows='3' cols='60' placeholder='Write the complete conditional sentences here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"conditionals\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Conditionals: Listen and Identify</h3>
            <p>Listen to **conditional sentences** and identify their types (zero, first, second, third). Pay attention to the verb tenses in both clauses.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3'></audio>
            <p><strong>Audio Quiz:</strong> You will hear a conditional sentence. Say out loud what type it is.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='Write the type of conditional for each sentence...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"conditionals\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Conditionals: Complete and Create</h3>
            <p>Complete **conditional sentences** and create your own. Read the grammar rules for each type of conditional and apply them in written exercises.</p>
            <p><strong>Zero Conditional:</strong> If + Present Simple, Present Simple (for facts). (e.g., *If you heat ice, it melts.*)</p>
            <p><strong>First Conditional:</strong> If + Present Simple, will + base verb (for real future possibilities). (e.g., *If it rains, I will stay home.*)</p>
            <p><strong>Second Conditional:</strong> If + Past Simple, would + base verb (for unreal present/future situations). (e.g., *If I had wings, I would fly.*)</p>
            <p><strong>Third Conditional:</strong> If + Past Perfect, would have + past participle (for unreal past situations). (e.g., *If I had studied, I would have passed.*)</p>
            <p><strong>Writing Exercise:</strong> Complete the following conditional sentences.</p>
            <ol>
                <li>If I (win) _____ the lottery, I (buy) _____ a house. (Second)</li>
                <li>If she (study) _____ harder, she (pass) _____ the exam. (First)</li>
                <li>If you (mix) _____ blue and yellow, you (get) _____ green. (Zero)</li>
                <li>If he (arrive) _____ earlier, he (see) _____ the show. (Third)</li>
            </ol>
            <textarea rows='10' cols='60' placeholder='Write your own conditional sentences here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"conditionals\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Conditionals: Build Sentences Actively</h3>
            <p>**Build conditional sentences** by dragging and dropping clauses. Manipulate the parts of the sentence to understand how they fit together to form different conditional types. ¬°Feel the grammar!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive conditional sentence builder: drag and drop clauses.</p>
              <p><em>Imagina you drag "If I had time" to "I would visit you".</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Write different conditional clauses on separate cards. Then, physically arrange them to form correct conditional sentences. Read them out loud.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"conditionals\")'>Simulate Game Completion</button>
          `
        },
        'listening-speaking': {
          visual: `
            <h3>Listening & Speaking: Video Comprehension</h3>
            <p>Watch **short English video clips** and answer comprehension questions. Use subtitles initially if needed, then try without them. Focus on visual cues to understand the context.</p>
            <video controls style='width:100%; height:auto;' src='https://www.w3schools.com/html/mov_bbb.mp4' poster='https://placehold.co/600x400/eef5fb/34495e?text=Listening+Video'></video>
            <p><strong>Visual Task:</strong> Describe what you see happening in the video in your own words.</p>
            <textarea rows='5' cols='60' placeholder='Describe the video scene here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"listening-speaking\")'>Complete lesson</button>
          `,
          auditivo: `
            <h3>Listening & Speaking: Audio Practice and Recording</h3>
            <p>Practice your **listening comprehension** with dialogues and quizzes. Then, record yourself speaking and compare your pronunciation to native speakers. Focus on intonation and rhythm!</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3'></audio>
            <p><strong>Recording Exercise:</strong> Listen to the dialogue and then record yourself saying the lines of one of the characters. Try to mimic their pronunciation and intonation.</p>
            <audio controls src='https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3'></audio>
            <textarea rows='3' cols='60' placeholder='After recording, write down what you learned...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"listening-speaking\")'>Complete lesson</button>
          `,
          'lectura-escritura': `
            <h3>Listening & Speaking: Transcripts and Summaries</h3>
            <p>Read **transcripts of conversations** and summarize them. Practice active listening by reading along and then writing down the main points and your understanding.</p>
            <p><strong>Transcript Example:</strong></p>
            <p><em>Speaker A: Hello, how are you today?</em></p>
            <p><em>Speaker B: I'm very well, thank you. And you?</em></p>
            <p><em>Speaker A: I'm great, thanks. I'm planning my vacation.</em></p>
            <p><em>Speaker B: Oh, where are you going?</em></p>
            <p><strong>Writing Exercise:</strong> Read the transcript above and write a short summary of the conversation.</p>
            <textarea rows='10' cols='60' placeholder='Summarize the conversation here...' style='width: 100%;'></textarea>
            <button onclick='simulateGameCompletion(\"ingles\", \"listening-speaking\")'>Complete lesson</button>
          `,
          kinestesico: `
            <h3>Listening & Speaking: Interactive Dialogues</h3>
            <p>**Participate in interactive dialogues** with prompts and role-playing scenarios. You'll respond to virtual characters, making the conversation feel real and engaging. ¬°Speak and move your mouth!</p>
            <div class='interactive-game-placeholder'>
              <p>Interactive speaking practice: respond to prompts from a virtual character.</p>
              <p><em>Imagina a chatbot asks "How are you?" and you have to speak your answer.</em></p>
            </div>
            <p><strong>Practical Activity:</strong> Find a partner (or use a mirror!) and role-play a simple conversation. Use gestures and body language to enhance your speaking practice.</p>
            <button onclick='simulateGameCompletion(\"ingles\", \"listening-speaking\")'>Simulate Game Completion</button>
          `
        }
      }
    };

    function showLessonContent(subject, topicId) {
        if (!isAuthenticated) {
            showMessage('Por favor, inicia sesi√≥n para acceder al contenido de las lecciones.');
            showAuthModal(); // Show auth modal if not authenticated
            return;
        }
        // Ocultar todas las p√°ginas de asignaturas y el contenido principal
        hideAuthModal();
        document.getElementById('main-content').classList.add('hidden'); // Oculta el contenido principal
        document.getElementById('quiz-container').classList.add('hidden'); // Oculta el quiz
        document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden')); // Oculta las p√°ginas de asignatura

        // Mostrar el contenedor de la lecci√≥n
        lessonContentDisplay.classList.remove('hidden'); // Asegurarse de que est√© visible
        lessonContentDisplay.classList.add('active'); // Activar para posibles estilos de transici√≥n

        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonMaterialElement = document.getElementById('lesson-material');

        // Formatear el ID del tema para el t√≠tulo de la lecci√≥n
        const topicName = topicId.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        const subjectName = subject.charAt(0).toUpperCase() + subject.slice(1);
        lessonTitleElement.textContent = `Lecci√≥n: ${topicName} de ${subjectName}`;

        // Obtener el contenido adaptado al estilo de aprendizaje del usuario
        let contentHtml = topicContents[subject] && topicContents[subject][topicId] && topicContents[subject][topicId][userLearningStyle];

        if (contentHtml) {
            lessonMaterialElement.innerHTML = contentHtml;
        } else {
            lessonMaterialElement.innerHTML = "<p>Contenido no disponible para este tema o estilo de aprendizaje a√∫n. ¬°Estamos trabajando en ello!</p>";
        }
    }

    function hideLessonContent() {
        lessonContentDisplay.classList.remove('active'); // Desactivar para posibles estilos de transici√≥n
        lessonContentDisplay.classList.add('hidden'); // Ocultar el contenido de la lecci√≥n

        // Obtener la p√°gina de asignatura activa antes de ocultar las otras (si existe)
        let previouslyActiveSubjectId = null;
        document.querySelectorAll('.subject-page').forEach(page => {
            // Verifica si tiene la clase 'active' que indica que estaba siendo mostrada
            if (page.classList.contains('active')) {
                previouslyActiveSubjectId = page.id.replace('-page', '');
                // No se remueve la clase 'active' aqu√≠, ya que `showSubject` la gestionar√°.
                // Simplemente marcamos que exist√≠a una p√°gina activa.
            }
        });
        
        // Si hab√≠a una p√°gina de asignatura activa, mostrarla de nuevo.
        // Si no, volver al contenido principal.
        if (previouslyActiveSubjectId) {
            showSubject(previouslyActiveSubjectId); // Re-activa la p√°gina de asignatura espec√≠fica
        } else {
            showMainContent(); // Vuelve a la p√°gina principal
        }
    }

    // Simular que un juego interactivo ha sido completado
    function simulateGameCompletion(subject, topicId) {
        showMessage('¬°Felicidades! Has completado el juego interactivo. Tu progreso ha sido guardado.', 4000);
        saveProgress(subject, topicId, 'completed');
        hideLessonContent(); // Oculta el contenido de la lecci√≥n y vuelve al temario
    }


    // Initial setup on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Initially hide all main content, quiz, and lesson displays
        // The onAuthStateChanged listener will handle showing the correct content
        // based on whether a user is logged in or not.

        // Ensure main content is visible on load, and auth modal is hidden
        mainContent.classList.remove('hidden');
        authModalOverlay.classList.add('hidden');
        quizContainer.classList.add('hidden');
        document.querySelectorAll('.subject-page').forEach(page => page.classList.add('hidden'));
        lessonContentDisplay.classList.add('hidden');
        
        // Hide quiz and logout links until authenticated
        quizNavLink.classList.add('hidden');
        logoutButton.classList.add('hidden');
        authNavLink.classList.remove('hidden'); // Ensure auth nav link is visible

        // Load progress for all subjects on initial page load
        loadProgressAndDisplay();
        updateAllProgressBars();
    });
  
  </script>
</body>
</html>
